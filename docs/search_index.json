[
["data-collect.html", "Chapter 3 Data collection 3.1 First example", " Chapter 3 Data collection ## Package version: 2.0.1 ## Parallel computing: 2 of 11 threads used. ## See https://quanteda.io for tutorials and examples. ## ## Attaching package: &#39;quanteda&#39; ## The following object is masked from &#39;package:utils&#39;: ## ## View 3.1 First example 3.1.1 Download of NYT stories with mediacloud interface We suppose that you want to analyze the title of the news collected by the New York Times during the first semester of 2020. You can easily proceed to such a collection with the application Mediacloud. https://explorer.mediacloud.org You need firstly to register (for free) in order to create an account. Then you can select your media, select your period and select all stories by using the request ’*’ as in the example presented below. Below your request, you obtain a graphic entitled Attention Over Time with the distribution of the number of news published per day which help you to verify if the distribution of news is regular through time. In our example, you an notice a classical week cycle (with decrease of the number of news publish during the week-end). But you can also observe a discontinuity at the beginning of May 2020 with a decline to a lower level of production of news. Going down, you will find a news panel entitled Total Attention which gives you the total number of stories found. In our example, we have a total of 47522 stories produced by the NYT during the first semester of 2020. Finally, by clicking on the button Download all story URLS, you can get a .csv file that you can easily load in your favourite porgramming language. In the case of R, you can load it with a program like this. ## [1] &quot;en_USA_nytime_20200101_20200630.csv&quot; stories_id publish_date title url language ap_syndicated themes media_id media_name media_url 1483747633 2020-01-01 00:00:08 Meteor Showers in 2020 That Will Light Up Night Skies https://www.nytimes.com/2020/01/01/science/meteor-showers-2020.html en False 1 New York Times http://nytimes.com 1483747632 2020-01-01 00:05:07 Rocket Launches, Trips to Mars and More 2020 Space and Astronomy Events https://www.nytimes.com/2020/01/01/science/space-astronomy-2020.html en False 1 New York Times http://nytimes.com 1483779604 2020-01-01 01:00:05 What’s on TV Wednesday: A Linda Ronstadt Doc and ‘Doctor Who’ https://www.nytimes.com/2020/01/01/arts/television/whats-on-tv-wednesday-a-linda-ronstadt-doc-and-doctor-who.html en False 1 New York Times http://nytimes.com ## &#39;data.frame&#39;: 30265 obs. of 10 variables: ## $ stories_id : int 1483747633 1483747632 1483779604 1483817555 1483817553 1483858519 1483858517 1483858514 1483858512 1483858499 ... ## $ publish_date : chr &quot;2020-01-01 00:00:08&quot; &quot;2020-01-01 00:05:07&quot; &quot;2020-01-01 01:00:05&quot; &quot;2020-01-01 03:00:11&quot; ... ## $ title : chr &quot;Meteor Showers in 2020 That Will Light Up Night Skies&quot; &quot;Rocket Launches, Trips to Mars and More 2020 Space and Astronomy Events&quot; &quot;What’s on TV Wednesday: A Linda Ronstadt Doc and ‘Doctor Who’&quot; &quot;Why Did the U.S. Become the Focus of Iraqis’ Anger?&quot; ... ## $ url : chr &quot;https://www.nytimes.com/2020/01/01/science/meteor-showers-2020.html&quot; &quot;https://www.nytimes.com/2020/01/01/science/space-astronomy-2020.html&quot; &quot;https://www.nytimes.com/2020/01/01/arts/television/whats-on-tv-wednesday-a-linda-ronstadt-doc-and-doctor-who.html&quot; &quot;https://www.nytimes.com/2020/01/01/world/middleeast/iraq-embassy-iran.html&quot; ... ## $ language : chr &quot;en&quot; &quot;en&quot; &quot;en&quot; &quot;en&quot; ... ## $ ap_syndicated: chr &quot;False&quot; &quot;False&quot; &quot;False&quot; &quot;False&quot; ... ## $ themes : chr &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; ... ## $ media_id : int 1 1 1 1 1 1 1 1 1 1 ... ## $ media_name : chr &quot;New York Times&quot; &quot;New York Times&quot; &quot;New York Times&quot; &quot;New York Times&quot; ... ## $ media_url : chr &quot;http://nytimes.com&quot; &quot;http://nytimes.com&quot; &quot;http://nytimes.com&quot; &quot;http://nytimes.com&quot; ... N.B. We can notice, without being able to explain this fact, that the number of stories downloaded (30265), which is less than what was announced by the mediacloud interface (47522). May be it is related to the elimination of duplicates ? 3.1.2 Transformation and storage in quanteda format. Currently, the size of the file (unzipped) is equal to 7.3 Mb. But we can observe that a lot of information are the same for all news and should not necessarily be kept. We can also exclude the url field if we are not interested in. We propose therefore to use a better form of storage based on quanteda format. # Create Quanteda corpus qd&lt;-corpus(df$title) # Add date qd$date&lt;-as.POSIXct(strptime(df$publish_date,&quot;%Y-%m-%d %H:%M:%S&quot;)) # Add initial meta meta(qd,&quot;language&quot;)&lt;-df$language[1] meta(qd,&quot;media_id&quot;)&lt;-df$media_id[1] meta(qd,&quot;media_name&quot;)&lt;-df$media_name[1] meta(qd,&quot;media_url&quot;)&lt;-df$media_url[1] # Add supplementary meta meta(qd,&quot;media_country&quot;)&lt;-&quot;USA&quot; meta(qd,&quot;data_source&quot;)&lt;-&quot;Media Cloud &quot; meta(qd,&quot;data_time&quot;)&lt;-&quot;Download the 2020-07-06&quot; meta(qd,&quot;data_author&quot;)&lt;-&quot;Elaborated by Claude Grasland&quot; We have created a quanteda object with a lot of information stored in various fields. The structure of the object is the following one str(qd) ## &#39;corpus&#39; Named chr [1:30265] &quot;Meteor Showers in 2020 That Will Light Up Night Skies&quot; ... ## - attr(*, &quot;names&quot;)= chr [1:30265] &quot;text1&quot; &quot;text2&quot; &quot;text3&quot; &quot;text4&quot; ... ## - attr(*, &quot;docvars&quot;)=&#39;data.frame&#39;: 30265 obs. of 4 variables: ## ..$ docname_: chr [1:30265] &quot;text1&quot; &quot;text2&quot; &quot;text3&quot; &quot;text4&quot; ... ## ..$ docid_ : Factor w/ 30265 levels &quot;text1&quot;,&quot;text2&quot;,..: 1 2 3 4 5 6 7 8 9 10 ... ## ..$ segid_ : int [1:30265] 1 1 1 1 1 1 1 1 1 1 ... ## ..$ date : POSIXct[1:30265], format: &quot;2020-01-01 00:00:08&quot; &quot;2020-01-01 00:05:07&quot; ... ## - attr(*, &quot;meta&quot;)=List of 3 ## ..$ system:List of 5 ## .. ..$ package-version:Classes &#39;package_version&#39;, &#39;numeric_version&#39; hidden list of 1 ## .. .. ..$ : int [1:3] 2 0 1 ## .. ..$ r-version :Classes &#39;R_system_version&#39;, &#39;package_version&#39;, &#39;numeric_version&#39; hidden list of 1 ## .. .. ..$ : int [1:3] 3 6 3 ## .. ..$ system : Named chr [1:3] &quot;Linux&quot; &quot;x86_64&quot; &quot;cgrasland&quot; ## .. .. ..- attr(*, &quot;names&quot;)= chr [1:3] &quot;sysname&quot; &quot;machine&quot; &quot;user&quot; ## .. ..$ directory : chr &quot;/data/user/g/cgrasland/newsbook&quot; ## .. ..$ created : Date[1:1], format: &quot;2020-07-06&quot; ## ..$ object:List of 1 ## .. ..$ unit: chr &quot;documents&quot; ## ..$ user :List of 8 ## .. ..$ language : chr &quot;en&quot; ## .. ..$ media_id : int 1 ## .. ..$ media_name : chr &quot;New York Times&quot; ## .. ..$ media_url : chr &quot;http://nytimes.com&quot; ## .. ..$ media_country: chr &quot;USA&quot; ## .. ..$ data_source : chr &quot;Media Cloud &quot; ## .. ..$ data_time : chr &quot;Download the 2020-07-06&quot; ## .. ..$ data_author : chr &quot;Elaborated by Claude Grasland&quot; We can look at the first titles with head() kable(head(qd,3)) x text1 Meteor Showers in 2020 That Will Light Up Night Skies text2 Rocket Launches, Trips to Mars and More 2020 Space and Astronomy Events text3 What’s on TV Wednesday: A Linda Ronstadt Doc and ‘Doctor Who’ We can get meta information on each stories with summary() summary(qd,3) ## Corpus consisting of 30265 documents, showing 3 documents: ## ## Text Types Tokens Sentences date ## text1 10 10 1 2020-01-01 00:00:08 ## text2 12 13 1 2020-01-01 00:05:07 ## text3 13 14 1 2020-01-01 01:00:05 We can get meta information about the full document meta(qd) ## $language ## [1] &quot;en&quot; ## ## $media_id ## [1] 1 ## ## $media_name ## [1] &quot;New York Times&quot; ## ## $media_url ## [1] &quot;http://nytimes.com&quot; ## ## $media_country ## [1] &quot;USA&quot; ## ## $data_source ## [1] &quot;Media Cloud &quot; ## ## $data_time ## [1] &quot;Download the 2020-07-06&quot; ## ## $data_author ## [1] &quot;Elaborated by Claude Grasland&quot; We can finally save the object in RDS format saveRDS(qd,&quot;_data/qd/en_USA_nytime_20200101_20200630.RDS&quot;) We have kept all the information present in the initial file, but also added specific metadata of interest for us. The size of the storage is now equal to 1.2Mb which means a division by 6 as compared to the initial .csv file downloaded from Media Cloud. "]
]
