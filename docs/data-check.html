<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Data Check and Clean | The R News Book</title>
  <meta name="description" content="This is a summary of experience and methods developped for the analysis of news flow." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Data Check and Clean | The R News Book" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a summary of experience and methods developped for the analysis of news flow." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Data Check and Clean | The R News Book" />
  
  <meta name="twitter:description" content="This is a summary of experience and methods developped for the analysis of news flow." />
  

<meta name="author" content="Claude Grasland, Romain Leconte, Hugues Pecout, Etienne Toureille, …" />


<meta name="date" content="2020-07-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-collect.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">My Book</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Objectives</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="data-collect.html"><a href="data-collect.html"><i class="fa fa-check"></i><b>3</b> Data collection</a><ul>
<li class="chapter" data-level="3.1" data-path="data-collect.html"><a href="data-collect.html#data-level-1-title-of-news"><i class="fa fa-check"></i><b>3.1</b> DATA LEVEL 1 : Title of news</a><ul>
<li class="chapter" data-level="3.1.1" data-path="data-collect.html"><a href="data-collect.html#download-titles-with-mediacloud-interface"><i class="fa fa-check"></i><b>3.1.1</b> Download titles with mediacloud interface</a></li>
<li class="chapter" data-level="3.1.2" data-path="data-collect.html"><a href="data-collect.html#transformation-and-storage-in-quanteda-format."><i class="fa fa-check"></i><b>3.1.2</b> Transformation and storage in quanteda format.</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="data-collect.html"><a href="data-collect.html#data-level-2-title-of-news-description"><i class="fa fa-check"></i><b>3.2</b> DATA LEVEL 2 : Title of news + description</a><ul>
<li class="chapter" data-level="3.2.1" data-path="data-collect.html"><a href="data-collect.html#metadata"><i class="fa fa-check"></i><b>3.2.1</b> metadata</a></li>
<li class="chapter" data-level="3.2.2" data-path="data-collect.html"><a href="data-collect.html#load-.csv-file"><i class="fa fa-check"></i><b>3.2.2</b> Load .csv file</a></li>
<li class="chapter" data-level="3.2.3" data-path="data-collect.html"><a href="data-collect.html#cleaning-the-html-code-in-description-file"><i class="fa fa-check"></i><b>3.2.3</b> Cleaning the html code in description file</a></li>
<li class="chapter" data-level="3.2.4" data-path="data-collect.html"><a href="data-collect.html#transformation-of-textdescription-in-quanteda-corpus"><i class="fa fa-check"></i><b>3.2.4</b> Transformation of text+description in quanteda corpus</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-collect.html"><a href="data-collect.html#data-level-3-full-text"><i class="fa fa-check"></i><b>3.3</b> DATA LEVEL 3 : Full text</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-check.html"><a href="data-check.html"><i class="fa fa-check"></i><b>4</b> Data Check and Clean</a><ul>
<li class="chapter" data-level="4.1" data-path="data-check.html"><a href="data-check.html#prerequites"><i class="fa fa-check"></i><b>4.1</b> Prerequites</a></li>
<li class="chapter" data-level="4.2" data-path="data-check.html"><a href="data-check.html#example-1-cleaning-a-textdescription-corpus"><i class="fa fa-check"></i><b>4.2</b> EXAMPLE 1 : Cleaning a text+description corpus</a><ul>
<li class="chapter" data-level="4.2.1" data-path="data-check.html"><a href="data-check.html#length-of-texts"><i class="fa fa-check"></i><b>4.2.1</b> length of texts</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/ClaudeGrasland/newsbook" target="blank"></a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The R News Book</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data_check" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Data Check and Clean</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="data-check.html#cb1-1"></a><span class="kw">library</span>(knitr)</span>
<span id="cb1-2"><a href="data-check.html#cb1-2"></a>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">echo =</span> <span class="ot">TRUE</span>, <span class="dt">warning =</span> <span class="ot">FALSE</span>, <span class="dt">message =</span> <span class="ot">FALSE</span>)</span>
<span id="cb1-3"><a href="data-check.html#cb1-3"></a><span class="kw">library</span>(quanteda)</span>
<span id="cb1-4"><a href="data-check.html#cb1-4"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb1-5"><a href="data-check.html#cb1-5"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb1-6"><a href="data-check.html#cb1-6"></a><span class="kw">library</span>(tidytext)</span></code></pre></div>
<p>In this chapter, we describe the different operation of checking and cleaning that should be necessarily realized before any sound exploration of corpus. The majority of the procedures described here can not be done automatically and implies a human expertise at each step in order to control the results and propose remediations in case of problems.</p>
<div id="prerequites" class="section level2">
<h2><span class="header-section-number">4.1</span> Prerequites</h2>
<p>The operations will be realized jointly with the two packages <strong>quanteda</strong> and <strong>tidytext</strong>. In the majority of case, we will use quanteda but in some specific situations tidytext will appear more adapted and will be used, thanks to (relatively) easy possibilities of exchange between the two format of dta storage of corpora.</p>
<ul>
<li>The reader non familiar with quanteda should have a look at <em>Quick Start</em> available on the website of the project :</li>
</ul>
<p><a href="https://quanteda.io/articles/quickstart.html" class="uri">https://quanteda.io/articles/quickstart.html</a></p>
<ul>
<li>The reader non familiar with tidytext will find detailed explnation in the following book :</li>
</ul>
<p><a href="https://www.tidytextmining.com/" class="uri">https://www.tidytextmining.com/</a></p>
</div>
<div id="example-1-cleaning-a-textdescription-corpus" class="section level2">
<h2><span class="header-section-number">4.2</span> EXAMPLE 1 : Cleaning a text+description corpus</h2>
<p>We start by loading the corpus of news from the french newspaper Sud-Ouest that has been extract from .csv and transform in quanteda corpus in the previous chapter (<strong>ref</strong>). we also transform the time variable in date and sort the news by historical order.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="data-check.html#cb2-1"></a>qd&lt;-<span class="kw">readRDS</span>(<span class="st">&quot;_data/qd/stories_41372.Rdata&quot;</span>)</span>
<span id="cb2-2"><a href="data-check.html#cb2-2"></a>qd<span class="op">$</span>date&lt;-<span class="kw">as.Date</span>(qd<span class="op">$</span>date)</span>
<span id="cb2-3"><a href="data-check.html#cb2-3"></a>qd&lt;-qd[<span class="kw">order</span>(qd<span class="op">$</span>date)]</span>
<span id="cb2-4"><a href="data-check.html#cb2-4"></a><span class="kw">str</span>(qd)</span></code></pre></div>
<pre><code>##  &#39;corpus&#39; Named chr [1:81653] &quot;« Sud Ouest » : Pierre Veilletet est mort.\n.&quot; ...
##  - attr(*, &quot;names&quot;)= chr [1:81653] &quot;text66408&quot; &quot;text77986&quot; &quot;text78223&quot; &quot;text66409&quot; ...
##  - attr(*, &quot;docvars&quot;)=&#39;data.frame&#39;:	81653 obs. of  4 variables:
##   ..$ docname_: chr [1:81653] &quot;text66408&quot; &quot;text77986&quot; &quot;text78223&quot; &quot;text66409&quot; ...
##   ..$ docid_  : Factor w/ 81653 levels &quot;text66408&quot;,&quot;text77986&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##   ..$ segid_  : int [1:81653] 1 1 1 1 1 1 1 1 1 1 ...
##   ..$ date    : Date[1:81653], format: &quot;2013-01-08&quot; &quot;2013-01-10&quot; ...
##  - attr(*, &quot;meta&quot;)=List of 3
##   ..$ system:List of 5
##   .. ..$ package-version:Classes &#39;package_version&#39;, &#39;numeric_version&#39;  hidden list of 1
##   .. .. ..$ : int [1:3] 2 1 0
##   .. ..$ r-version      :Classes &#39;R_system_version&#39;, &#39;package_version&#39;, &#39;numeric_version&#39;  hidden list of 1
##   .. .. ..$ : int [1:3] 4 0 2
##   .. ..$ system         : Named chr [1:3] &quot;Windows&quot; &quot;x86-64&quot; &quot;CIST&quot;
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:3] &quot;sysname&quot; &quot;machine&quot; &quot;user&quot;
##   .. ..$ directory      : chr &quot;C:/claude/git/newsbook&quot;
##   .. ..$ created        : Date[1:1], format: &quot;2020-07-08&quot;
##   ..$ object:List of 2
##   .. ..$ unit   : chr &quot;documents&quot;
##   .. ..$ summary:List of 2
##   .. .. ..$ hash: chr(0) 
##   .. .. ..$ data: NULL
##   ..$ user  :List of 7
##   .. ..$ media_id     : int 41372
##   .. ..$ media_name   : chr &quot;Sud Ouest&quot;
##   .. ..$ media_url    : chr &quot;http://www.sudouest.fr/&quot;
##   .. ..$ media_country: chr &quot;FRA&quot;
##   .. ..$ data_source  : chr &quot;Media Cloud &quot;
##   .. ..$ data_time    : chr &quot;Special extraction&quot;
##   .. ..$ data_author  : chr &quot;Elaborated by Claude Grasland&quot;</code></pre>
<p>This structure of data appears a bit tricky at first glance (especially for old user of quanteda that has experimented modification between version 1 and 2 …) but it offers very good guaranties of quality and efficiency. As explained by the author of the quanteda package :</p>
<blockquote>
<p>A corpus is designed to be a “library” of original documents that have been converted to plain, UTF-8 encoded text, and stored along with meta-data at the corpus level and at the document-level. We have a special name for document-level meta-data: <em>docvars</em>. These are variables or features that describe attributes of each document.A corpus is designed to be a more or less static container of texts with respect to processing and analysis. This means that the texts in corpus are not designed to be changed internally through (for example) cleaning or pre-processing steps, such as stemming or removing punctuation. Rather, texts can be extracted from the corpus as part of processing, and assigned to new objects, but the idea is that the corpus will remain as an original reference copy so that other analyses – for instance those in which stems and punctuation were required, such as analyzing a reading ease index – can be performed on the same corpus.</p>
</blockquote>
<p>With the new data structure it is for example easy to extract a specific text from the corpus with an extractor, called <code>texts()</code>. We can also have an easy access to information associated to each document like the date in our example. For example the news 666 is defined by :</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="data-check.html#cb4-1"></a><span class="kw">texts</span>(qd)[<span class="dv">666</span>]</span></code></pre></div>
<pre><code>##                                                                                                                                                                                                                                                                                                                                                                                                      text49394 
## &quot;Béarn : un technicien électrocuté par une ligne à 63 000 volts.\n.Le technicien, qui était sur une nacelle, aurait été victime d’un arc électrique. La police a ouvert une enquête.Un dramatique accident s’est produit jeudi après-midi vers 16 h 30 sur le site Euralis à Lescar. Un homme est mort électrocuté alors qu’il travaillait sur une nacelle à une dizaine de mètres du sol, à... Lire la suite&quot;</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="data-check.html#cb6-1"></a>qd<span class="op">$</span>date[<span class="dv">666</span>]</span></code></pre></div>
<pre><code>## [1] &quot;2013-04-19&quot;</code></pre>
<p>For those who really don’t want to use quanteda, it is also simple to convert it to other format and in particular a simple data.frame where we can find only the id of document, the text and the document level information. But we have lost all the other information like the document metadata.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="data-check.html#cb8-1"></a>df&lt;-<span class="kw">convert</span>(qd, <span class="dt">to=</span><span class="st">&quot;data.frame&quot;</span>)</span>
<span id="cb8-2"><a href="data-check.html#cb8-2"></a><span class="kw">head</span>(df)</span></code></pre></div>
<pre><code>##      doc_id
## 1 text66408
## 2 text77986
## 3 text78223
## 4 text66409
## 5  text2245
## 6 text55308
##                                                                          text
## 1                               « Sud Ouest » : Pierre Veilletet est mort.\n.
## 2                       Municipales à Pau : Bayrou entretient le suspense.\n.
## 3 Algérie : Yann Desjeux, l’otage originaire du Pays basque, tué vendredi.\n.
## 4     Bègles : il avait conçu et réalisé le dernier album d’Yvette Horner.\n.
## 5                                    Le football pleure Jacques Grimonpon.\n.
## 6                             Mariage pour tous : Jean Lassalle a dit non.\n.
##         date
## 1 2013-01-08
## 2 2013-01-10
## 3 2013-01-18
## 4 2013-01-20
## 5 2013-01-25
## 6 2013-02-12</code></pre>
<div id="length-of-texts" class="section level3">
<h3><span class="header-section-number">4.2.1</span> length of texts</h3>
<p>We can use the summary command applied to the whole corpus in order to obtain for each text the number of sentences and words. This operation can take some time because quanteda will proceed to a tokenization of the corpus. We suggest to store this information in the quanteda object.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="data-check.html#cb10-1"></a><span class="co"># Compute number of sentences and tokens</span></span>
<span id="cb10-2"><a href="data-check.html#cb10-2"></a>tokeninfo &lt;-<span class="st"> </span><span class="kw">summary</span>(qd,<span class="kw">length</span>(qd))</span>
<span id="cb10-3"><a href="data-check.html#cb10-3"></a></span>
<span id="cb10-4"><a href="data-check.html#cb10-4"></a><span class="co">#store in quanteda object</span></span>
<span id="cb10-5"><a href="data-check.html#cb10-5"></a><span class="kw">docvars</span>(qd, <span class="dt">field=</span><span class="st">&quot;Tokens&quot;</span>)&lt;-tokeninfo<span class="op">$</span>Tokens</span>
<span id="cb10-6"><a href="data-check.html#cb10-6"></a><span class="kw">docvars</span>(qd, <span class="dt">field=</span><span class="st">&quot;Sentences&quot;</span>)&lt;-tokeninfo<span class="op">$</span>Sentences</span>
<span id="cb10-7"><a href="data-check.html#cb10-7"></a></span>
<span id="cb10-8"><a href="data-check.html#cb10-8"></a><span class="co"># Visualize</span></span>
<span id="cb10-9"><a href="data-check.html#cb10-9"></a><span class="kw">head</span>(<span class="kw">docvars</span>(qd))</span></code></pre></div>
<pre><code>##         date Tokens Sentences
## 1 2013-01-08     11         1
## 2 2013-01-10     10         1
## 3 2013-01-18     15         1
## 4 2013-01-20     14         1
## 5 2013-01-25      7         1
## 6 2013-02-12     11         1</code></pre>
<div id="what-is-the-distribution-of-the-number-of-sentences" class="section level4">
<h4><span class="header-section-number">4.2.1.1</span> What is the distribution of the number of sentences ?</h4>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="data-check.html#cb12-1"></a>x&lt;-qd<span class="op">$</span>Sentences</span>
<span id="cb12-2"><a href="data-check.html#cb12-2"></a></span>
<span id="cb12-3"><a href="data-check.html#cb12-3"></a><span class="kw">kable</span>(<span class="kw">table</span>(x),<span class="dt">caption =</span> <span class="st">&quot;Number of sentences of news&quot;</span>, <span class="dt">digits=</span><span class="dv">1</span>) </span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-7">Table 4.1: </span>Number of sentences of news</caption>
<thead>
<tr class="header">
<th align="left">x</th>
<th align="right">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="right">1950</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">287</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="right">12772</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="right">30262</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="right">23324</td>
</tr>
<tr class="even">
<td align="left">6</td>
<td align="right">9578</td>
</tr>
<tr class="odd">
<td align="left">7</td>
<td align="right">2719</td>
</tr>
<tr class="even">
<td align="left">8</td>
<td align="right">568</td>
</tr>
<tr class="odd">
<td align="left">9</td>
<td align="right">141</td>
</tr>
<tr class="even">
<td align="left">10</td>
<td align="right">37</td>
</tr>
<tr class="odd">
<td align="left">11</td>
<td align="right">11</td>
</tr>
<tr class="even">
<td align="left">12</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">18</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">57</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>The distribution appears regular with the exception of a very strange news with 57 sentences. It appears as a single case of full text ! We decide therefore to eliminate all texts with length &gt; 10 sentences and visualize the result.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="data-check.html#cb13-1"></a>qd&lt;-qd[qd<span class="op">$</span>Sentences<span class="op">&lt;</span><span class="dv">11</span>]</span>
<span id="cb13-2"><a href="data-check.html#cb13-2"></a>p&lt;-<span class="kw">ggplot</span>(<span class="kw">docvars</span>(qd),<span class="kw">aes</span>(<span class="dt">x=</span>Sentences))<span class="op">+</span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>,)</span>
<span id="cb13-3"><a href="data-check.html#cb13-3"></a>p</span></code></pre></div>
<p><img src="newsbook_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>N.B. At this point, it is also possible to harmonize the number of sentences in the datasets.But rather than deleting the “long” texts", it appears better to keep only the k first sentences of each text with the <em>corpus_reshape</em> function. This function can transform the initial text in sentences but also do the reverse operation. So, our program could look like this. Note that the operation can take some time on large corpora.</p>
</div>
<div id="what-is-the-distribution-of-the-number-of-tokens" class="section level4">
<h4><span class="header-section-number">4.2.1.2</span> What is the distribution of the number of tokens ?</h4>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="data-check.html#cb14-1"></a>nbtoks&lt;-qd<span class="op">$</span>Tokens</span>
<span id="cb14-2"><a href="data-check.html#cb14-2"></a>p&lt;-<span class="kw">ggplot</span>(<span class="kw">docvars</span>(qd),<span class="kw">aes</span>(<span class="dt">x=</span>Tokens))<span class="op">+</span><span class="kw">geom_histogram</span>()</span>
<span id="cb14-3"><a href="data-check.html#cb14-3"></a>p</span></code></pre></div>
<p><img src="newsbook_files/figure-html/unnamed-chunk-9-1.png" width="672" />
One more time, we observe some strange behavior with some very short news. We can therefore decide to harmonize and keep only the news with a value of 50 to 125 tokens.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="data-check.html#cb15-1"></a>qd&lt;-<span class="kw">corpus_subset</span>(qd,Tokens<span class="op">&gt;</span><span class="dv">50</span>)</span>
<span id="cb15-2"><a href="data-check.html#cb15-2"></a>qd&lt;-<span class="kw">corpus_subset</span>(qd,Tokens<span class="op">&lt;</span><span class="dv">125</span>)</span>
<span id="cb15-3"><a href="data-check.html#cb15-3"></a></span>
<span id="cb15-4"><a href="data-check.html#cb15-4"></a>p&lt;-<span class="kw">ggplot</span>(<span class="kw">docvars</span>(qd),<span class="kw">aes</span>(<span class="dt">x=</span>Tokens))<span class="op">+</span><span class="kw">geom_histogram</span>(<span class="dt">stat_bin=</span><span class="dv">25</span>)</span>
<span id="cb15-5"><a href="data-check.html#cb15-5"></a>p</span></code></pre></div>
<p><img src="newsbook_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-collect.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ClaudeGrasland/newsbook/edit/master/03-data_check.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["newsbook.pdf", "newsbook.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
