<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Data Check and Clean | The R News Book</title>
  <meta name="description" content="This is a summary of experience and methods developped for the analysis of news flow." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Data Check and Clean | The R News Book" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a summary of experience and methods developped for the analysis of news flow." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Data Check and Clean | The R News Book" />
  
  <meta name="twitter:description" content="This is a summary of experience and methods developped for the analysis of news flow." />
  

<meta name="author" content="Claude Grasland, Romain Leconte, Hugues Pecout, Etienne Toureille, …" />


<meta name="date" content="2020-07-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-collect.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">My Book</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Objectives</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="data-collect.html"><a href="data-collect.html"><i class="fa fa-check"></i><b>3</b> Data collection</a><ul>
<li class="chapter" data-level="3.1" data-path="data-collect.html"><a href="data-collect.html#data-level-1-title-of-news"><i class="fa fa-check"></i><b>3.1</b> DATA LEVEL 1 : Title of news</a><ul>
<li class="chapter" data-level="3.1.1" data-path="data-collect.html"><a href="data-collect.html#download-titles-with-mediacloud-interface"><i class="fa fa-check"></i><b>3.1.1</b> Download titles with mediacloud interface</a></li>
<li class="chapter" data-level="3.1.2" data-path="data-collect.html"><a href="data-collect.html#transformation-and-storage-in-quanteda-format."><i class="fa fa-check"></i><b>3.1.2</b> Transformation and storage in quanteda format.</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="data-collect.html"><a href="data-collect.html#data-level-2-title-of-news-description"><i class="fa fa-check"></i><b>3.2</b> DATA LEVEL 2 : Title of news + description</a><ul>
<li class="chapter" data-level="3.2.1" data-path="data-collect.html"><a href="data-collect.html#cleaning-the-html-code-in-description-file"><i class="fa fa-check"></i><b>3.2.1</b> Cleaning the html code in description file</a></li>
<li class="chapter" data-level="3.2.2" data-path="data-collect.html"><a href="data-collect.html#transformation-of-textdescription-in-quanteda-corpus"><i class="fa fa-check"></i><b>3.2.2</b> Transformation of text+description in quanteda corpus</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-collect.html"><a href="data-collect.html#data-level-3-full-text"><i class="fa fa-check"></i><b>3.3</b> DATA LEVEL 3 : Full text</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-check.html"><a href="data-check.html"><i class="fa fa-check"></i><b>4</b> Data Check and Clean</a><ul>
<li class="chapter" data-level="4.1" data-path="data-check.html"><a href="data-check.html#prerequites-quanteda-or-tidytext"><i class="fa fa-check"></i><b>4.1</b> Prerequites : quanteda (or tidytext)</a></li>
<li class="chapter" data-level="4.2" data-path="data-check.html"><a href="data-check.html#check-1-length-of-texts"><i class="fa fa-check"></i><b>4.2</b> CHECK 1 : length of texts</a><ul>
<li class="chapter" data-level="4.2.1" data-path="data-check.html"><a href="data-check.html#number-of-sentences"><i class="fa fa-check"></i><b>4.2.1</b> Number of sentences</a></li>
<li class="chapter" data-level="4.2.2" data-path="data-check.html"><a href="data-check.html#number-of-tokens"><i class="fa fa-check"></i><b>4.2.2</b> Number of tokens</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="data-check.html"><a href="data-check.html#check-2-time-distribution"><i class="fa fa-check"></i><b>4.3</b> CHECK 2 : Time distribution</a><ul>
<li class="chapter" data-level="4.3.1" data-path="data-check.html"><a href="data-check.html#news-without-date"><i class="fa fa-check"></i><b>4.3.1</b> News without date</a></li>
<li class="chapter" data-level="4.3.2" data-path="data-check.html"><a href="data-check.html#distribution-of-news-through-time"><i class="fa fa-check"></i><b>4.3.2</b> Distribution of news through time</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="data-check.html"><a href="data-check.html#check-3-suspect-words"><i class="fa fa-check"></i><b>4.4</b> CHECK 3 : Suspect words</a><ul>
<li class="chapter" data-level="4.4.1" data-path="data-check.html"><a href="data-check.html#tips-1-simple-word-fequencies"><i class="fa fa-check"></i><b>4.4.1</b> Tips 1 : simple word fequencies</a></li>
<li class="chapter" data-level="4.4.2" data-path="data-check.html"><a href="data-check.html#tips-2-most-frequent-n-grams"><i class="fa fa-check"></i><b>4.4.2</b> Tips 2 : most frequent n-grams</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="data-check.html"><a href="data-check.html#check-4-human-expertise"><i class="fa fa-check"></i><b>4.5</b> CHECK 4 : Human expertise</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/ClaudeGrasland/newsbook" target="blank"></a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The R News Book</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data_check" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Data Check and Clean</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="data-check.html#cb1-1"></a><span class="kw">library</span>(knitr)</span>
<span id="cb1-2"><a href="data-check.html#cb1-2"></a>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">echo =</span> <span class="ot">TRUE</span>, <span class="dt">warning =</span> <span class="ot">FALSE</span>, <span class="dt">message =</span> <span class="ot">FALSE</span>)</span>
<span id="cb1-3"><a href="data-check.html#cb1-3"></a><span class="kw">library</span>(quanteda)</span>
<span id="cb1-4"><a href="data-check.html#cb1-4"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb1-5"><a href="data-check.html#cb1-5"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb1-6"><a href="data-check.html#cb1-6"></a><span class="kw">library</span>(tidytext)</span></code></pre></div>
<p>In this chapter, we describe the different operation of checking and cleaning that should be necessarily realized before any sound exploration of corpus. The majority of the procedures described here can not be done automatically and implies a human expertise at each step in order to control the results and propose remediations in case of problems.</p>
<div id="prerequites-quanteda-or-tidytext" class="section level2">
<h2><span class="header-section-number">4.1</span> Prerequites : quanteda (or tidytext)</h2>
<p>The operations will be realized jointly with the two packages <strong>quanteda</strong> and <strong>tidytext</strong>. In the majority of case, we will use quanteda but in some specific situations tidytext will appear more adapted and will be used, thanks to (relatively) easy possibilities of exchange between the two format of dta storage of corpora.</p>
<ul>
<li>The reader non familiar with quanteda should have a look at <em>Quick Start</em> available on the website of the project :</li>
</ul>
<p><a href="https://quanteda.io/articles/quickstart.html" class="uri">https://quanteda.io/articles/quickstart.html</a></p>
<ul>
<li>The reader non familiar with tidytext will find detailed explnation in the following book :</li>
</ul>
<p><a href="https://www.tidytextmining.com/" class="uri">https://www.tidytextmining.com/</a></p>
<p>We start by loading the corpus of news from <em>The Guardian (UK)</em> that has been transformed into quanteda corpus in the previous chapter (<strong>ref</strong>). we also transform the time variable in date and sort the news by historical order.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="data-check.html#cb2-1"></a>qd&lt;-<span class="kw">readRDS</span>(<span class="st">&quot;_data/qd/en_GBR_guardi.Rdata&quot;</span>)</span>
<span id="cb2-2"><a href="data-check.html#cb2-2"></a>qd<span class="op">$</span>date&lt;-<span class="kw">as.Date</span>(qd<span class="op">$</span>date)</span>
<span id="cb2-3"><a href="data-check.html#cb2-3"></a>qd&lt;-qd[<span class="kw">order</span>(qd<span class="op">$</span>date)]</span>
<span id="cb2-4"><a href="data-check.html#cb2-4"></a><span class="kw">str</span>(qd)</span></code></pre></div>
<pre><code>##  &#39;corpus&#39; Named chr [1:160855] &quot;20 great Ashes moments No1: Shane Warne&#39;s ball of the century, 1993 | Barney Ronay.\n.The Australian spinner&#39;s &quot;| __truncated__ ...
##  - attr(*, &quot;names&quot;)= chr [1:160855] &quot;text117863&quot; &quot;text43964&quot; &quot;text149258&quot; &quot;text81406&quot; ...
##  - attr(*, &quot;docvars&quot;)=&#39;data.frame&#39;:  160855 obs. of  4 variables:
##   ..$ docname_: chr [1:160855] &quot;text117863&quot; &quot;text43964&quot; &quot;text149258&quot; &quot;text81406&quot; ...
##   ..$ docid_  : Factor w/ 160855 levels &quot;text1&quot;,&quot;text2&quot;,..: 117863 43964 149258 81406 104515 9780 71819 137743 104492 118066 ...
##   ..$ segid_  : int [1:160855] 1 1 1 1 1 1 1 1 1 1 ...
##   ..$ date    : Date[1:160855], format: &quot;2013-04-29&quot; &quot;2013-05-02&quot; ...
##  - attr(*, &quot;meta&quot;)=List of 3
##   ..$ system:List of 5
##   .. ..$ package-version:Classes &#39;package_version&#39;, &#39;numeric_version&#39;  hidden list of 1
##   .. .. ..$ : int [1:3] 2 0 1
##   .. ..$ r-version      :Classes &#39;R_system_version&#39;, &#39;package_version&#39;, &#39;numeric_version&#39;  hidden list of 1
##   .. .. ..$ : int [1:3] 3 6 3
##   .. ..$ system         : Named chr [1:3] &quot;Linux&quot; &quot;x86_64&quot; &quot;cgrasland&quot;
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:3] &quot;sysname&quot; &quot;machine&quot; &quot;user&quot;
##   .. ..$ directory      : chr &quot;/data/user/g/cgrasland/newsbook&quot;
##   .. ..$ created        : Date[1:1], format: &quot;2020-07-09&quot;
##   ..$ object:List of 1
##   .. ..$ unit: chr &quot;documents&quot;
##   ..$ user  :List of 8
##   .. ..$ media_id     : num 300560
##   .. ..$ media_name   : chr &quot;The Guardian UK&quot;
##   .. ..$ media_url    : chr &quot;http://www.theguardian.com/uk&quot;
##   .. ..$ language     : chr &quot;en&quot;
##   .. ..$ media_country: chr &quot;FRA&quot;
##   .. ..$ data_source  : chr &quot;Media Cloud &quot;
##   .. ..$ data_time    : chr &quot;Special extraction&quot;
##   .. ..$ data_author  : chr &quot;Elaborated by Claude Grasland&quot;</code></pre>
<p>This structure of data appears a bit tricky at first glance (especially for old user of quanteda that has experimented modification between version 1 and 2 …) but it offers very good guaranties of quality and efficiency. As explained by the author of the quanteda package :</p>
<blockquote>
<p>A corpus is designed to be a “library” of original documents that have been converted to plain, UTF-8 encoded text, and stored along with meta-data at the corpus level and at the document-level. We have a special name for document-level meta-data: <em>docvars</em>. These are variables or features that describe attributes of each document.A corpus is designed to be a more or less static container of texts with respect to processing and analysis. This means that the texts in corpus are not designed to be changed internally through (for example) cleaning or pre-processing steps, such as stemming or removing punctuation. Rather, texts can be extracted from the corpus as part of processing, and assigned to new objects, but the idea is that the corpus will remain as an original reference copy so that other analyses – for instance those in which stems and punctuation were required, such as analyzing a reading ease index – can be performed on the same corpus.</p>
</blockquote>
<p>With the new data structure it is for example easy to extract a specific text from the corpus with an extractor, called <code>texts()</code>. We can also have an easy access to information associated to each document like the date in our example. For example the news 666 is defined by :</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="data-check.html#cb4-1"></a><span class="kw">texts</span>(qd)[<span class="dv">666</span>]</span></code></pre></div>
<pre><code>##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        text156682 
## &quot;The state pension top-up that no one seems to want.\n.More than a quarter of a million people were expected to boost their pension; fewer than 4,000 have signed up so farIt&#39;s the great deal no one seems to know about. The government is running a scheme whereby older people can buy extra state pension on what experts say are \&quot;very favourable\&quot; terms  -  but the take-up so far has been shockingly low.The official prediction was that 265,000 people would take advantage of the chance to boost their retirement income by making an upfront payment. But figures published this week show that fewer than 4,000 signed up in the first six months. Here we explain how the scheme works, why you should do it, and things to watch out for. Continue reading...&quot;</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="data-check.html#cb6-1"></a>qd<span class="op">$</span>date[<span class="dv">666</span>]</span></code></pre></div>
<pre><code>## [1] &quot;2016-08-20&quot;</code></pre>
<p>For those who really don’t want to use quanteda, it is also simple to convert it to other format and in particular a simple data.frame where we can find only the id of document, the text and the document level information. But we have lost all the other information like the document metadata.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="data-check.html#cb8-1"></a>df&lt;-<span class="kw">convert</span>(qd, <span class="dt">to=</span><span class="st">&quot;data.frame&quot;</span>)</span>
<span id="cb8-2"><a href="data-check.html#cb8-2"></a><span class="kw">head</span>(df)</span></code></pre></div>
<pre><code>##       doc_id
## 1 text117863
## 2  text43964
## 3 text149258
## 4  text81406
## 5 text104515
## 6   text9780
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              text
## 1 20 great Ashes moments No1: Shane Warne&#39;s ball of the century, 1993 | Barney Ronay.\n.The Australian spinner&#39;s drifting, leaping leg-break to bowl Mike Gatting at Old Trafford introduced the cricket world to a new heroThere shouldn&#39;t really be anything left to say about Warne&#39;s Ball, otherwise known as Shane Warne&#39;s opening delivery in Ashes cricket; or more commonly as The Ball of the Century, Birth of A Superstar, Awakening of the Kraken, the Jailhouse Rock of Australia&#39;s custard-blond leg-break Elvis, and so on ad infinitum.In part this is simply because so much has already been said and written, an entire vast, groaning medieval library of ball talk, from the historian&#39;s cold-eyed anatomy to the biographer&#39;s partisan gurgles. And partly because the ball itself has become so enmeshed in its own mille-feuille of well-worn superlatives that there is a fear the moment itself has also become a cliche, a mini-industry of middle-aged hyperbole, asserting its own wonderfulness more insistently with each receding year. Perhaps Warne&#39;s Ball might even have begun to look a bit like Warne himself these days: waxworked and framed, glistening with the acquired privilege of athletic celebrity and generally hanging around the place being oppressively eminent long after its own meaningful cricketing life has ended. Continue reading...
## 2                                                                                                                                                                                    20 great Ashes moments No2: the miracle of Cardiff, 2009 | Rob Bagchi.\n.Spectators who dared to look did so through their fingers as Monty Panesar and Jimmy Anderson held on for a drawIt is to Britain&#39;s martial and imperial past that the metaphors for a home team&#39;s defiance of overwhelming odds still habitually turn when honour, even in retreat, is salvaged from a seemingly inevitable ignominious fate. Dunkirk and its fabled spirit, a cornered belligerence and breezy fortitude in the face of imminent catastrophe, is the most common analogy but for England&#39;s draw with Australia in the opening match of the 2009 Ashes series, something more symbolically Welsh was required to commemorate Cardiff and the country&#39;s first ever Test.For the generations brought up on the annual televised screening of the 1964 film Zulu, the Battle of Rorke&#39;s Drift and specifically the poignant if apocryphal singing of Men of Harlech by a hopelessly outnumbered company of the 24th Regiment of Foot valiantly defending their position and lives against 4,000 warriors, suggested the obvious soundtrack to the highlight reels of Sunday at the Swalec Stadium. Continue reading...
## 3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     The Joy of Six: red mist in football | Scott Murray and Rob Smyth.\n.Frank Rijkaard and Rudi Völler bond during West Germany&#39;s match against Holland at Italia 90. Photograph: Getty Images
## 4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Official World Cup balls: a potted history  -  in pictures.\n.Since 1970, Adidas have had the honour of producing the official match balls for the World Cup finals. With the announcement for the Telstar 18 for 2018 Russia, we take a look back at the balls that have graced the finals over the past 43 years Continue reading...
## 5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Weather view: photos of this week&#39;s weather  -  by readers around the world.\n.We&#39;re looking for your best beautiful and striking weather-related photos. From cloudy skies to glorious sunshine, share your pictures of this week&#39;s weather and we&#39;ll choose a selection to be printed in the paperFrom heatwaves in Australia, to snow in the US and Middle East, to storms and flooding in the UK, you&#39;ve shared some dramatic images with the Guardian. But the weather doesn&#39;t have to be extreme to make a great picture. Wherever you are in the world, we&#39;d love to see your most striking photos of this week&#39;s weather.In your description, please tell us where you took the photo (it can be anywhere in the world) and the date you took it (it should be in the last week). Continue reading...
## 6                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                The Joy of Six: football pantomime villains | Paul Doyle.\n.From the loathing for Pepe&#39;s playacting to the puzzling rancour Michael Owen inspires, football fans love to hate a bad guyA distinction must be drawn between &quot;football pantomime villains&quot; and real-life villains associated with football, such as Uday Hussein, Robert Maxwell or Lee Hughes, men who have committed misdeeds too grave for any enjoyment to be had from contemplating them. Continue reading...
##         date
## 1 2013-04-29
## 2 2013-05-02
## 3 2013-11-29
## 4 2013-12-03
## 5 2014-01-13
## 6 2014-04-18</code></pre>
</div>
<div id="check-1-length-of-texts" class="section level2">
<h2><span class="header-section-number">4.2</span> CHECK 1 : length of texts</h2>
<p>We can use the summary command applied to the whole corpus in order to obtain for each text the number of sentences and words. This operation can take some time because quanteda will proceed to a tokenization of the corpus. We suggest to store this information in the quanteda object.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="data-check.html#cb10-1"></a><span class="co"># Compute number of sentences and tokens</span></span>
<span id="cb10-2"><a href="data-check.html#cb10-2"></a>tokeninfo &lt;-<span class="st"> </span><span class="kw">summary</span>(qd,<span class="kw">length</span>(qd))</span>
<span id="cb10-3"><a href="data-check.html#cb10-3"></a></span>
<span id="cb10-4"><a href="data-check.html#cb10-4"></a><span class="co">#store in quanteda object</span></span>
<span id="cb10-5"><a href="data-check.html#cb10-5"></a><span class="kw">docvars</span>(qd, <span class="dt">field=</span><span class="st">&quot;Tokens&quot;</span>)&lt;-tokeninfo<span class="op">$</span>Tokens</span>
<span id="cb10-6"><a href="data-check.html#cb10-6"></a><span class="kw">docvars</span>(qd, <span class="dt">field=</span><span class="st">&quot;Sentences&quot;</span>)&lt;-tokeninfo<span class="op">$</span>Sentences</span>
<span id="cb10-7"><a href="data-check.html#cb10-7"></a></span>
<span id="cb10-8"><a href="data-check.html#cb10-8"></a><span class="co"># Visualize</span></span>
<span id="cb10-9"><a href="data-check.html#cb10-9"></a><span class="kw">head</span>(<span class="kw">docvars</span>(qd))</span></code></pre></div>
<pre><code>##         date Tokens Sentences
## 1 2013-04-29    234         5
## 2 2013-05-02    202         4
## 3 2013-11-29     37         3
## 4 2013-12-03     67         3
## 5 2014-01-13    156         6
## 6 2014-04-18     85         3</code></pre>
<div id="number-of-sentences" class="section level3">
<h3><span class="header-section-number">4.2.1</span> Number of sentences</h3>
<p>We examine the number of sentences of texts</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="data-check.html#cb12-1"></a>nsent&lt;-qd<span class="op">$</span>Sentences</span>
<span id="cb12-2"><a href="data-check.html#cb12-2"></a><span class="kw">summary</span>(nsent)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   1.000   3.000   4.000   5.694   7.000 204.000</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="data-check.html#cb14-1"></a>p&lt;-<span class="kw">ggplot</span>(<span class="kw">docvars</span>(qd),<span class="kw">aes</span>(<span class="dt">x=</span>Sentences))<span class="op">+</span><span class="kw">geom_histogram</span>()</span>
<span id="cb14-2"><a href="data-check.html#cb14-2"></a>p</span></code></pre></div>
<p><img src="newsbook_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>The distribution appears strongly asymmetric with a majority of news with 3 to 7 sentences but a minoity with much longer size. We can zoom on the news with less than 20 sentences for a better view of the distribution :</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="data-check.html#cb15-1"></a>qd2&lt;-qd[qd<span class="op">$</span>Sentences<span class="op">&lt;</span><span class="dv">20</span>]</span>
<span id="cb15-2"><a href="data-check.html#cb15-2"></a>p&lt;-<span class="kw">ggplot</span>(<span class="kw">docvars</span>(qd2),<span class="kw">aes</span>(<span class="dt">x=</span>Sentences))<span class="op">+</span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>,)</span>
<span id="cb15-3"><a href="data-check.html#cb15-3"></a>p</span></code></pre></div>
<p><img src="newsbook_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>At this point, it could be useful to proceed to an harmonisation of the length of texts with two possibles options :</p>
<ul>
<li>delete the news with too much sentences</li>
<li>keep only the k first sentences of each text with the <em>corpus_reshape</em> function.</li>
</ul>
<p>But we do not want here to anaticipate on what will decide the user so we let the issue open.</p>
</div>
<div id="number-of-tokens" class="section level3">
<h3><span class="header-section-number">4.2.2</span> Number of tokens</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="data-check.html#cb16-1"></a>nbtoks&lt;-qd<span class="op">$</span>Tokens</span>
<span id="cb16-2"><a href="data-check.html#cb16-2"></a><span class="kw">summary</span>(nbtoks)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    12.0   101.0   127.0   146.5   179.0  3362.0</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="data-check.html#cb18-1"></a>p&lt;-<span class="kw">ggplot</span>(<span class="kw">docvars</span>(qd),<span class="kw">aes</span>(<span class="dt">x=</span>Tokens))<span class="op">+</span><span class="kw">geom_histogram</span>()</span>
<span id="cb18-2"><a href="data-check.html#cb18-2"></a>p</span></code></pre></div>
<p><img src="newsbook_files/figure-html/unnamed-chunk-9-1.png" width="672" />
We observe the same asymmetry for the number of tokens. In the ajority of case, the number of tokens is comprise between 100 and 180 Tokens but the minimum is 12 and the maximum 3362.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="data-check.html#cb19-1"></a>p&lt;-<span class="kw">ggplot</span>(<span class="kw">docvars</span>(qd2),<span class="kw">aes</span>(<span class="dt">x=</span>Tokens))<span class="op">+</span><span class="kw">geom_histogram</span>(<span class="dt">stat_bin=</span><span class="dv">25</span>)<span class="op">+</span><span class="kw">scale_x_continuous</span>(<span class="dt">lim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">300</span>))</span>
<span id="cb19-2"><a href="data-check.html#cb19-2"></a>p</span></code></pre></div>
<p><img src="newsbook_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
</div>
<div id="check-2-time-distribution" class="section level2">
<h2><span class="header-section-number">4.3</span> CHECK 2 : Time distribution</h2>
<p>The second step is to verify the stability of the news through times, in terms of frequencies. The main danger here is the risk to observe discontinuities in the distribution which could induce biases in the comparison of evolution through time.</p>
<div id="news-without-date" class="section level3">
<h3><span class="header-section-number">4.3.1</span> News without date</h3>
<p>After a check of the time distribution of news, we eliminate 22 news without date</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="data-check.html#cb20-1"></a><span class="kw">summary</span>(<span class="kw">docvars</span>(qd,<span class="st">&quot;date&quot;</span>))</span></code></pre></div>
<pre><code>##         Min.      1st Qu.       Median         Mean      3rd Qu.         Max. 
## &quot;2013-04-29&quot; &quot;2017-07-22&quot; &quot;2018-07-04&quot; &quot;2018-07-19&quot; &quot;2019-07-25&quot; &quot;2020-06-30&quot;</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="data-check.html#cb22-1"></a>qd&lt;-qd[<span class="kw">is.na</span>(qd<span class="op">$</span>date)<span class="op">==</span>F]</span></code></pre></div>
</div>
<div id="distribution-of-news-through-time" class="section level3">
<h3><span class="header-section-number">4.3.2</span> Distribution of news through time</h3>
<p>We introduce a function when_count for an easier extraction of time series with different levels of time span. The interest of this function is to add zero value for time period where no news has been observed, which would not be the case with a simple table function.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="data-check.html#cb23-1"></a><span class="co">#### ---------------- when_count -----------------</span></span>
<span id="cb23-2"><a href="data-check.html#cb23-2"></a><span class="co">#&#39; @title identify number of news per time period</span></span>
<span id="cb23-3"><a href="data-check.html#cb23-3"></a><span class="co">#&#39; @name when_count</span></span>
<span id="cb23-4"><a href="data-check.html#cb23-4"></a><span class="co">#&#39; @description count the numbers of news per time period and add zero for missing period</span></span>
<span id="cb23-5"><a href="data-check.html#cb23-5"></a><span class="co">#&#39; @param corpus a corpus of news (in qd format) with a column &quot;time&quot;</span></span>
<span id="cb23-6"><a href="data-check.html#cb23-6"></a><span class="co">#&#39; @param span a time period of aggregation (days, weeks, months, year)</span></span>
<span id="cb23-7"><a href="data-check.html#cb23-7"></a></span>
<span id="cb23-8"><a href="data-check.html#cb23-8"></a></span>
<span id="cb23-9"><a href="data-check.html#cb23-9"></a></span>
<span id="cb23-10"><a href="data-check.html#cb23-10"></a>when_count&lt;-<span class="cf">function</span>(<span class="dt">corpus =</span> qd, <span class="dt">span =</span> <span class="st">&#39;weeks&#39;</span> )</span>
<span id="cb23-11"><a href="data-check.html#cb23-11"></a>{</span>
<span id="cb23-12"><a href="data-check.html#cb23-12"></a> <span class="co"># corpus&lt;-qd</span></span>
<span id="cb23-13"><a href="data-check.html#cb23-13"></a><span class="co">#  span&lt;-&quot;weeks&quot;</span></span>
<span id="cb23-14"><a href="data-check.html#cb23-14"></a></span>
<span id="cb23-15"><a href="data-check.html#cb23-15"></a>  </span>
<span id="cb23-16"><a href="data-check.html#cb23-16"></a>  time&lt;-<span class="kw">docvars</span>(corpus,<span class="st">&quot;date&quot;</span>)</span>
<span id="cb23-17"><a href="data-check.html#cb23-17"></a>  tab&lt;-tibble<span class="op">::</span><span class="kw">tibble</span>(<span class="dt">date=</span><span class="kw">as.Date</span>(time))</span>
<span id="cb23-18"><a href="data-check.html#cb23-18"></a>  item_date &lt;-<span class="st"> </span>tab <span class="op">%&gt;%</span></span>
<span id="cb23-19"><a href="data-check.html#cb23-19"></a><span class="st">    </span><span class="kw">group_by</span>(<span class="dt">date =</span> <span class="kw">cut</span>(date, span, <span class="dt">start.on.monday =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></span>
<span id="cb23-20"><a href="data-check.html#cb23-20"></a><span class="st">    </span><span class="kw">summarise</span>(<span class="dt">nb =</span> <span class="kw">n</span>())</span>
<span id="cb23-21"><a href="data-check.html#cb23-21"></a>  item_date<span class="op">$</span>date &lt;-<span class="st"> </span><span class="kw">as.Date</span>(item_date<span class="op">$</span>date)</span>
<span id="cb23-22"><a href="data-check.html#cb23-22"></a>  all_date&lt;-<span class="kw">data_frame</span>(<span class="dt">date=</span><span class="kw">seq</span>(<span class="kw">min</span>(<span class="kw">as.Date</span>(item_date<span class="op">$</span>date)),<span class="kw">max</span>(<span class="kw">as.Date</span>(item_date<span class="op">$</span>date)),span))</span>
<span id="cb23-23"><a href="data-check.html#cb23-23"></a>  tem_date&lt;-<span class="kw">left_join</span>(all_date,item_date)</span>
<span id="cb23-24"><a href="data-check.html#cb23-24"></a>  item_date<span class="op">$</span>nb[<span class="kw">is.na</span>(item_date<span class="op">$</span>nb)]&lt;-<span class="dv">0</span></span>
<span id="cb23-25"><a href="data-check.html#cb23-25"></a>  </span>
<span id="cb23-26"><a href="data-check.html#cb23-26"></a>  <span class="kw">return</span>(item_date)</span>
<span id="cb23-27"><a href="data-check.html#cb23-27"></a>}</span></code></pre></div>
<div id="daily-distribtion" class="section level4">
<h4><span class="header-section-number">4.3.2.1</span> daily distribtion</h4>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="data-check.html#cb24-1"></a>news_by_day&lt;-<span class="kw">when_count</span>(qd,<span class="dt">span=</span><span class="st">&quot;days&quot;</span>)</span>
<span id="cb24-2"><a href="data-check.html#cb24-2"></a>p&lt;-<span class="kw">ggplot</span>(news_by_day, <span class="kw">aes</span>(<span class="dt">x=</span>date, <span class="dt">y=</span>nb)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>()<span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="kw">max</span>(news_by_day<span class="op">$</span>nb)))</span>
<span id="cb24-3"><a href="data-check.html#cb24-3"></a>p</span></code></pre></div>
<p><img src="newsbook_files/figure-html/news_by_day-1.png" width="672" />
We discover here that, despite the fact that the first news is observed the 29 April 2013, it is only after the 15th August 2016 that the flow of news become regular with an average level of 100 news per day. Therefore we reduce the sample to this period :</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="data-check.html#cb25-1"></a>qd&lt;-<span class="kw">corpus_subset</span>(qd,qd<span class="op">$</span>date<span class="op">&gt;</span><span class="kw">as.Date</span>(<span class="st">&quot;2016-08-14&quot;</span>))</span>
<span id="cb25-2"><a href="data-check.html#cb25-2"></a>news_by_day&lt;-<span class="kw">when_count</span>(qd,<span class="dt">span=</span><span class="st">&quot;days&quot;</span>)</span>
<span id="cb25-3"><a href="data-check.html#cb25-3"></a>p&lt;-<span class="kw">ggplot</span>(news_by_day, <span class="kw">aes</span>(<span class="dt">x=</span>date, <span class="dt">y=</span>nb)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>()<span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="kw">max</span>(news_by_day<span class="op">$</span>nb)))</span>
<span id="cb25-4"><a href="data-check.html#cb25-4"></a>p</span></code></pre></div>
<p><img src="newsbook_files/figure-html/news_by_day_2-1.png" width="672" />
For the new period, we can say that the flow is relatively regular, with very few discontinuities corresponding to zero news during one or several days.</p>
</div>
<div id="weekly-distribtion" class="section level4">
<h4><span class="header-section-number">4.3.2.2</span> weekly distribtion</h4>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="data-check.html#cb26-1"></a>news_by_week&lt;-<span class="kw">when_count</span>(qd,<span class="dt">span=</span><span class="st">&quot;weeks&quot;</span>)</span>
<span id="cb26-2"><a href="data-check.html#cb26-2"></a>p&lt;-<span class="kw">ggplot</span>(news_by_week, <span class="kw">aes</span>(<span class="dt">x=</span>date, <span class="dt">y=</span>nb)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="kw">max</span>(news_by_week<span class="op">$</span>nb)))</span>
<span id="cb26-3"><a href="data-check.html#cb26-3"></a>p</span></code></pre></div>
<p><img src="newsbook_files/figure-html/news_by_week-1.png" width="672" />
The analysis by week reveals a clear perturabation during the weeks of 23 March 2019 and 3 February 2020. The other decline observed at the end of the years 2016, 2018, 2019 and 2020 are not related to problems of data collection but rather to a reduction of the activity of journalist between X’mas and New Year.Surprisingly, this decline is not observed at the end of the year 2017. The final decline is related to the fact that the final week starting the 29 June 2020 is not complete because colection stopped the 30 june 2020.</p>
</div>
</div>
</div>
<div id="check-3-suspect-words" class="section level2">
<h2><span class="header-section-number">4.4</span> CHECK 3 : Suspect words</h2>
<p>A classical problem with the news collected from RSS is the existence of sequence of words that are not related to news itself but to newspaper structure. For example, the systematic addition of a copyright (<em>(c) the Journal</em>) or the introduction of references (<em>See also</em>) and many other things that can be considered as external to the message provided by the news itself. Here they are no miracle solution that can produce an automatic correction. But some technics can help the analyst to simplify the task of correction.</p>
<div id="tips-1-simple-word-fequencies" class="section level3">
<h3><span class="header-section-number">4.4.1</span> Tips 1 : simple word fequencies</h3>
<p>A simple analysis of most frequent tokens can help to discover suspect words.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="data-check.html#cb27-1"></a>toks&lt;-<span class="kw">tokens</span>(qd, <span class="dt">remove_numbers =</span> <span class="ot">TRUE</span>, <span class="dt">remove_punct =</span> <span class="ot">TRUE</span>, <span class="dt">remove_separators =</span><span class="ot">TRUE</span>)</span>
<span id="cb27-2"><a href="data-check.html#cb27-2"></a>dfm &lt;-<span class="st"> </span><span class="kw">dfm</span>(toks, <span class="dt">remove =</span> <span class="kw">stopwords</span>(<span class="st">&quot;english&quot;</span>))</span>
<span id="cb27-3"><a href="data-check.html#cb27-3"></a>top10&lt;-<span class="kw">textstat_frequency</span>(dfm,<span class="dt">n=</span><span class="dv">10</span>)</span>
<span id="cb27-4"><a href="data-check.html#cb27-4"></a><span class="kw">kable</span>(top10)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">feature</th>
<th align="right">frequency</th>
<th align="right">rank</th>
<th align="right">docfreq</th>
<th align="left">group</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">continue</td>
<td align="right">163470</td>
<td align="right">1</td>
<td align="right">160796</td>
<td align="left">all</td>
</tr>
<tr class="even">
<td align="left">reading</td>
<td align="right">163101</td>
<td align="right">2</td>
<td align="right">160796</td>
<td align="left">all</td>
</tr>
<tr class="odd">
<td align="left">new</td>
<td align="right">48062</td>
<td align="right">3</td>
<td align="right">33796</td>
<td align="left">all</td>
</tr>
<tr class="even">
<td align="left">one</td>
<td align="right">46211</td>
<td align="right">4</td>
<td align="right">35376</td>
<td align="left">all</td>
</tr>
<tr class="odd">
<td align="left">first</td>
<td align="right">36072</td>
<td align="right">5</td>
<td align="right">27221</td>
<td align="left">all</td>
</tr>
<tr class="even">
<td align="left">people</td>
<td align="right">34905</td>
<td align="right">6</td>
<td align="right">24863</td>
<td align="left">all</td>
</tr>
<tr class="odd">
<td align="left">us</td>
<td align="right">34461</td>
<td align="right">7</td>
<td align="right">23281</td>
<td align="left">all</td>
</tr>
<tr class="even">
<td align="left">said</td>
<td align="right">31617</td>
<td align="right">8</td>
<td align="right">26350</td>
<td align="left">all</td>
</tr>
<tr class="odd">
<td align="left">years</td>
<td align="right">29797</td>
<td align="right">9</td>
<td align="right">23772</td>
<td align="left">all</td>
</tr>
<tr class="even">
<td align="left">world</td>
<td align="right">28970</td>
<td align="right">10</td>
<td align="right">20444</td>
<td align="left">all</td>
</tr>
</tbody>
</table>
<p>The simple examination of the top 10 reveals the existence of two suspect words <em>continue</em> and <em>reading</em>. They can be explained by the existence of the string <em>Continue Reading</em> at the end of the majority of news. For example :</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="data-check.html#cb28-1"></a><span class="kw">texts</span>(qd)[<span class="dv">24</span>]</span></code></pre></div>
<pre><code>##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        text91459 
## &quot;Liverpool have been rebuilding … so why is Alberto Moreno still at left-back?.\n.The Spanish defender was exposed on numerous occasions against Arsenal and looks a clear weak link in a squad that Jürgen Klopp has otherwise strengthenedLiverpool started their season in triumphant fashion on Sunday with a 4-3 win at the Emirates that included two amazing goals from Philippe Coutinho (if we think he meant to score the second off his shin), a stunning strike from Sadio Mané and some, shall we say, inconsistent defending by the left-back Alberto Moreno. Related: Liverpool and Coutinho stun stuttering Arsenal in seven-goal thriller  Continue reading...&quot;</code></pre>
</div>
<div id="tips-2-most-frequent-n-grams" class="section level3">
<h3><span class="header-section-number">4.4.2</span> Tips 2 : most frequent n-grams</h3>
<p>Another approach consist in the extraction of most frequent n-grams i.e. couples of words frequently associated. This can be done with various value of n. But it is generally sufficient to check for n= 2, 3 or 4.*</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="data-check.html#cb30-1"></a>bigram&lt;-<span class="kw">tokens_ngrams</span>(toks,<span class="dt">n=</span><span class="kw">c</span>(<span class="dv">2</span>))</span>
<span id="cb30-2"><a href="data-check.html#cb30-2"></a>dfm2&lt;-<span class="kw">dfm</span>(bigram)</span>
<span id="cb30-3"><a href="data-check.html#cb30-3"></a>top10&lt;-<span class="kw">textstat_frequency</span>(dfm2,<span class="dt">n=</span><span class="dv">10</span>)</span>
<span id="cb30-4"><a href="data-check.html#cb30-4"></a><span class="kw">kable</span>(top10)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">feature</th>
<th align="right">frequency</th>
<th align="right">rank</th>
<th align="right">docfreq</th>
<th align="left">group</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">continue_reading</td>
<td align="right">160797</td>
<td align="right">1</td>
<td align="right">160796</td>
<td align="left">all</td>
</tr>
<tr class="even">
<td align="left">of_the</td>
<td align="right">114212</td>
<td align="right">2</td>
<td align="right">72939</td>
<td align="left">all</td>
</tr>
<tr class="odd">
<td align="left">in_the</td>
<td align="right">99856</td>
<td align="right">3</td>
<td align="right">67805</td>
<td align="left">all</td>
</tr>
<tr class="even">
<td align="left">to_the</td>
<td align="right">46941</td>
<td align="right">4</td>
<td align="right">38320</td>
<td align="left">all</td>
</tr>
<tr class="odd">
<td align="left">on_the</td>
<td align="right">40862</td>
<td align="right">5</td>
<td align="right">33652</td>
<td align="left">all</td>
</tr>
<tr class="even">
<td align="left">for_the</td>
<td align="right">33358</td>
<td align="right">6</td>
<td align="right">28214</td>
<td align="left">all</td>
</tr>
<tr class="odd">
<td align="left">at_the</td>
<td align="right">32416</td>
<td align="right">7</td>
<td align="right">27312</td>
<td align="left">all</td>
</tr>
<tr class="even">
<td align="left">in_a</td>
<td align="right">32270</td>
<td align="right">8</td>
<td align="right">27641</td>
<td align="left">all</td>
</tr>
<tr class="odd">
<td align="left">to_be</td>
<td align="right">30885</td>
<td align="right">9</td>
<td align="right">25541</td>
<td align="left">all</td>
</tr>
<tr class="even">
<td align="left">of_a</td>
<td align="right">29406</td>
<td align="right">10</td>
<td align="right">25280</td>
<td align="left">all</td>
</tr>
</tbody>
</table>
<p>Here, the conclusion is clear concerning our usual suspect. We can therefore proceed to the elimination of the problem with a regular expression</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="data-check.html#cb31-1"></a><span class="kw">texts</span>(qd)&lt;-<span class="kw">gsub</span>(<span class="st">&quot;continue reading...&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="kw">texts</span>(qd))</span>
<span id="cb31-2"><a href="data-check.html#cb31-2"></a><span class="kw">texts</span>(qd)&lt;-<span class="kw">gsub</span>(<span class="st">&quot;continue reading&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="kw">texts</span>(qd))</span></code></pre></div>
</div>
</div>
<div id="check-4-human-expertise" class="section level2">
<h2><span class="header-section-number">4.5</span> CHECK 4 : Human expertise</h2>
<p>All the previous check can not replace human expert. Therefore, we strongly suggest to examine a random sample of texts extract from the news in order to have an empirical view on the texts that will be further subject to time consuming analysis. It is certainly not a vaste of time to discover issues early and avoid to replicate the whole work (pity for the climate !).</p>
<p>A random sample of news can be easily extracted with corpus_sample function. Let’s take a sample of 10 here (but 100 would be certainly better)</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="data-check.html#cb32-1"></a>samp&lt;-<span class="kw">corpus_sample</span>(qd,<span class="dt">size=</span><span class="dv">10</span>)</span>
<span id="cb32-2"><a href="data-check.html#cb32-2"></a><span class="kw">texts</span>(samp)</span></code></pre></div>
<pre><code>##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     text6881 
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          &quot;Teenage murderer of Alesha MacPhail named as Aaron Campbell.\n.Judge allows name of boy who abducted, raped and killed girl on Bute to be reportedThe 16-year-old boy found guilty of the abduction, rape and murder of Alesha MacPhail on the Isle of Bute last July can be named as Aaron Thomas Campbell.The trial judge, Lord Matthews, lifted the ban following an application brought by a number of media organisations, which argued that naming him would be in the public interest. Continue reading...&quot; 
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   text112737 
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      &quot;The end of coffee: could Australia save the world&#39;s beans?.\n.Climate change may devastate the globe&#39;s major coffee-growing regions through extreme weather events  -  but Australia could be the solution If a future of relentless fires, droughts, superstorms and rising sea levels makes you feel like you need a strong caffeinated beverage, there is some bad news: climate change is coming for the world&#39;s coffee beans.Greg Meenahan, the partnership director at the non-profit institute World Coffee Research, puts it this way: \&quot;Demand for coffee is expected to double by the year 2050 and, if nothing is done, more than half of the world&#39;s suitable coffee land will be pushed into unsuitability due to climate change. Without research and development, the coffee sector will need up to 180m more bags of coffee in 2050 than we are likely to have.\&quot; Continue reading...&quot; 
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    text36921 
## &quot;Border by Kapka Kassabova review  -  magic in the corner of Europe.\n.This is a marvellous, personal account of the border zone between Bulgaria, Turkey and Greece, from the Ottomans to cold war menace and beyondKapka Kassabova has written a marvellous book about a magical part of the world. In Europe&#39;s southeastern corner, where Greece, Bulgaria and Turkey meet, modernity seems to peter out in the ancient forests. The low mountains that give the Balkans their name force most of the traffic between Europe and Asia to run either side of them, while providing shelter and sanctuary over the centuries in their secluded valleys, and not only to the bears and wolves that still roam them. Strange rites and superstitions survive, customs and beliefs that have vanished elsewhere. Deep in the roadless uplands there are remote Bektashi temples, the remnants of that humane and mystical strain of Sufi Islam that accompanied the Ottoman armies centuries ago. High in the mountains of Thrace each August, crowds gather to watch the great wrestling bouts in the meadows.Thirty years ago, when Bulgaria lay on the other side of the iron curtain, the easiest way into these mountains was from the south, a flight into Salonica and then the eastbound train that ran towards Istanbul. It rumbled slowly along the beautiful Nestos valley, curving inland away from the sea because that was how the Turkish sultan Abdul Hamid II had instructed the engineers when it was built. Eventually you would arrive at Xanthi, a quiet old tobacco town that had seen better days: the market did a lively trade in locally produced Ralph Lauren rip-offs. The Muslim quarter, its mansions largely unchanged since Ottoman times, climbed the hill behind the new town, and behind it, the road ran up into the Rhodope forests. Continue reading...&quot; 
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    text75725 
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        &quot;Fuel tanker explosion kills scores in Tanzania.\n.At least 60 dead and 70 injured by blast as people siphoned petrol from crashed tankerAt least 60 people have been killed and 70 injured after a fuel tanker exploded in Tanzania following a collision.The tanker burst into flames as crowds gathered to siphon petrol from the vehicle in Morogoro, about 125 miles (200km) west of the commercial capital, Dar es Salaam. Continue reading...&quot; 
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   text137717 
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             &quot;Rowers on Loch Katrine, October 2015.\n.This week the our weekly archive print series takes us to the Scottish Highlands for an image of a traditional boat race in late autumnRowers compete in an event on picturesque Loch Katrine in the Scottish Highlands, north-west of Stirling. They are surrounded by all the colours of late autumn, captured from a nearby peak by the Guardian photographer Murdo MacLeod. The competitors, from the Scottish Coastal Rowing Association, row in old-fashioned wooden boats whose design is based on traditional vessels from Fair Isle in the far north that were used for fishing and transport to nearby Shetland and Orkney. The eight-mile-long freshwater loch is famous as the fictional setting of Sir Walter Scott&#39;s 1810 poem The Lady of the Lake. Continue reading...&quot; 
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    text24730 
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        &quot;From Catullus to Dylan Thomas: the top 10 elegies.\n.They date back to ancient times and remain a strong current in modern poetry. Here are some of the best Elegy, an individual response to the death of a person or a group, began in Greece and Rome as a particular metrical form. But elegies are among the greatest poems in every language, whatever their form. Traditionally, they mirror three elements of mourning: grief; memories of the dead; and some kind of consolation  -  because people in grief often find relief in poems expressing a loss they thought was unique to them.  But elegy took me completely by surprise, just as death itself can do. When I began work on my new collection Emerald, I was simply interested in the gems themselves, their mining, myths, geology, history. I talked to emerald cutters, pondered the paradoxical symbolism of green, colour of envy and poison as well as magic. Then, very suddenly, my 97-year old mum was rushed to hospital. During that dark time, the emeralds surprised me by triggering a flood of poems about her: her jokes and determination, the pleasure she took in talking to old friends, the generous mutual support of everyone in the family as she died; my childhood memories of her; snapshots of her childhood.  Continue reading...&quot; 
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   text121512 
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     &quot;From Tiger Woods to World Cup memories: our favourite sports books of 2018.\n.The story of the 1936 Olympics, tales from the soul of English cricket, a charlatan footballer called Kaiser and the remarkable Doddie Weir all take pride of place on our bookshelvesIn the crowded world of sporting fame, to be known universally by a single name lifts an athlete closer to the stars. Few have flown so far into the stratosphere  -  and plummeted with such Icarusian suddenness  -  as Tiger. History suggests his flight is far from over. Continue reading...&quot; 
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   text137084 
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    &quot;Sexy beasts: why Brexit is giving zoo animals the horn.\n.UK breeders are hastily shipping in potential suitors for their rare species in the hope that they get it on ahead of a no-deal scenarioName: Brexit breeding.Age: Very much of its time. Continue reading...&quot; 
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   text145781 
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   &quot;UK environmentalists target Barclays in fossil fuels campaign.\n.Protest&#39;s organisers say bank invested more $30bn in 15 fossil fuel projects from 2012-17A UK-wide campaign is being launched to persuade one of the country&#39;s biggest high street banks to stop investing billions of pounds in the fossil fuel industry.Activists from the Labour-supporting Momentum group will team up with the environmental group People and Planet to stage more than 40 \&quot;creative direct actions\&quot; at Barclays branches in town and cities across the UK later this month. Continue reading...&quot; 
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    text27619 
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           &quot;Can&#39;t we judge people on their merits, instead of their genes? | Catherine Shoard.\n.The obsession with pedigree as an explanation for success and failure is just a present day form of narcissismAre the novelist Anthony Powell and the actor Danny Dyer related? The biology has yet to be checked, but the evidence is compelling. Spiritually, at least, these two are blood brothers, intimately linked. Both are entertainers, both are fans of the pithy putdown (Powell: \&quot;His mastery of the hard-luck story was of a kind never achieved by persons not wholly concentrated on themselves\&quot;; Dyer: \&quot;Mate, you look like an earthworm who&#39;s whacked a hoodie on\&quot;). And both are raging snobs. For Powell, lineage was of paramount importance, Burke&#39;s Peerage his favourite book. Between writing, he&amp;nbsp;devoted his studies to his own ancestry. The pedigree of others determined his attitude to them, from aristo pals to the postman. For all, he endeavoured to trace their descent back as far  -  and as posh  -  as possible. Related: Who Do You Think You Are? review  -  arise, King Danny Dyer  Continue reading...&quot;</code></pre>
<p>The sample appears correct but some corrections could be added. We could for example eliminate the double quotes that will complicate the analysis of text. We could also decide to eliminate the final sentences that are not completed, etc. But it can also be important to keep the text as similar as possible to the initial one and to delay these final check to the next chapter where the data will be focused on a specific question.</p>
<p>The last step here is to store the clean file for further use. Here we use the initial name but with adding information on the period of coverage.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="data-check.html#cb34-1"></a><span class="kw">saveRDS</span>(qd, <span class="st">&quot;_data/qd/en_GBR_guardi_20160815_20200630.Rdata&quot;</span>)</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-collect.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ClaudeGrasland/newsbook/edit/master/03-data_check.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["newsbook.pdf", "newsbook.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
