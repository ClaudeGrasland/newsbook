<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Data Check and Clean | The R News Book</title>
  <meta name="description" content="This is a summary of experience and methods developped for the analysis of news flow." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Data Check and Clean | The R News Book" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a summary of experience and methods developped for the analysis of news flow." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Data Check and Clean | The R News Book" />
  
  <meta name="twitter:description" content="This is a summary of experience and methods developped for the analysis of news flow." />
  

<meta name="author" content="Claude Grasland, Romain Leconte, Hugues Pecout, Etienne Toureille, …" />


<meta name="date" content="2020-07-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-collect.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">My Book</a></li>

<li class="divider"></li>
<li class="part"><span><b>I Objectives of the book</b></span></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Why ?</a></li>
<li class="part"><span><b>II DATA COLLECTION</b></span></li>
<li class="chapter" data-level="2" data-path="data-collect.html"><a href="data-collect.html"><i class="fa fa-check"></i><b>2</b> Data collection</a><ul>
<li class="chapter" data-level="2.1" data-path="data-collect.html"><a href="data-collect.html#data-level-1-title-of-news"><i class="fa fa-check"></i><b>2.1</b> DATA LEVEL 1 : Title of news</a><ul>
<li class="chapter" data-level="2.1.1" data-path="data-collect.html"><a href="data-collect.html#download-titles-with-mediacloud-interface"><i class="fa fa-check"></i><b>2.1.1</b> Download titles with mediacloud interface</a></li>
<li class="chapter" data-level="2.1.2" data-path="data-collect.html"><a href="data-collect.html#transformation-and-storage-in-quanteda-format."><i class="fa fa-check"></i><b>2.1.2</b> Transformation and storage in quanteda format.</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="data-collect.html"><a href="data-collect.html#data-level-2-title-of-news-description"><i class="fa fa-check"></i><b>2.2</b> DATA LEVEL 2 : Title of news + description</a><ul>
<li class="chapter" data-level="2.2.1" data-path="data-collect.html"><a href="data-collect.html#cleaning-the-html-code-in-description-file"><i class="fa fa-check"></i><b>2.2.1</b> Cleaning the html code in description file</a></li>
<li class="chapter" data-level="2.2.2" data-path="data-collect.html"><a href="data-collect.html#transformation-of-textdescription-in-quanteda-corpus"><i class="fa fa-check"></i><b>2.2.2</b> Transformation of text+description in quanteda corpus</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data-collect.html"><a href="data-collect.html#data-level-3-full-text"><i class="fa fa-check"></i><b>2.3</b> DATA LEVEL 3 : Full text</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-check.html"><a href="data-check.html"><i class="fa fa-check"></i><b>3</b> Data Check and Clean</a><ul>
<li class="chapter" data-level="3.1" data-path="data-check.html"><a href="data-check.html#prerequites-quanteda-or-tidytext"><i class="fa fa-check"></i><b>3.1</b> Prerequites : quanteda (or tidytext)</a></li>
<li class="chapter" data-level="3.2" data-path="data-check.html"><a href="data-check.html#check-1-length-of-texts"><i class="fa fa-check"></i><b>3.2</b> CHECK 1 : length of texts</a><ul>
<li class="chapter" data-level="3.2.1" data-path="data-check.html"><a href="data-check.html#number-of-sentences"><i class="fa fa-check"></i><b>3.2.1</b> Number of sentences</a></li>
<li class="chapter" data-level="3.2.2" data-path="data-check.html"><a href="data-check.html#number-of-tokens"><i class="fa fa-check"></i><b>3.2.2</b> Number of tokens</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-check.html"><a href="data-check.html#check-2-time-distribution"><i class="fa fa-check"></i><b>3.3</b> CHECK 2 : Time distribution</a><ul>
<li class="chapter" data-level="3.3.1" data-path="data-check.html"><a href="data-check.html#news-without-date"><i class="fa fa-check"></i><b>3.3.1</b> News without date</a></li>
<li class="chapter" data-level="3.3.2" data-path="data-check.html"><a href="data-check.html#distribution-of-news-through-time"><i class="fa fa-check"></i><b>3.3.2</b> Distribution of news through time</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-check.html"><a href="data-check.html#check-3-suspect-words"><i class="fa fa-check"></i><b>3.4</b> CHECK 3 : Suspect words</a><ul>
<li class="chapter" data-level="3.4.1" data-path="data-check.html"><a href="data-check.html#tips-1-simple-word-fequencies"><i class="fa fa-check"></i><b>3.4.1</b> Tips 1 : simple word fequencies</a></li>
<li class="chapter" data-level="3.4.2" data-path="data-check.html"><a href="data-check.html#tips-2-most-frequent-n-grams"><i class="fa fa-check"></i><b>3.4.2</b> Tips 2 : most frequent n-grams</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="data-check.html"><a href="data-check.html#check-4-human-expertise"><i class="fa fa-check"></i><b>3.5</b> CHECK 4 : Human expertise</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/ClaudeGrasland/newsbook" target="blank"></a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The R News Book</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data_check" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Data Check and Clean</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="data-check.html#cb1-1"></a><span class="kw">library</span>(knitr)</span>
<span id="cb1-2"><a href="data-check.html#cb1-2"></a>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">echo =</span> <span class="ot">TRUE</span>, <span class="dt">warning =</span> <span class="ot">FALSE</span>, <span class="dt">message =</span> <span class="ot">FALSE</span>)</span>
<span id="cb1-3"><a href="data-check.html#cb1-3"></a><span class="kw">library</span>(quanteda)</span>
<span id="cb1-4"><a href="data-check.html#cb1-4"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb1-5"><a href="data-check.html#cb1-5"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb1-6"><a href="data-check.html#cb1-6"></a><span class="kw">library</span>(tidytext)</span></code></pre></div>
<p>In this chapter, we describe the different operation of checking and cleaning that should be necessarily realized before any sound exploration of corpus. The majority of the procedures described here can not be done automatically and implies a human expertise at each step in order to control the results and propose remediations in case of problems.</p>
<div id="prerequites-quanteda-or-tidytext" class="section level2">
<h2><span class="header-section-number">3.1</span> Prerequites : quanteda (or tidytext)</h2>
<p>The operations will be realized jointly with the two packages <strong>quanteda</strong> and <strong>tidytext</strong>. In the majority of case, we will use quanteda but in some specific situations tidytext will appear more adapted and will be used, thanks to (relatively) easy possibilities of exchange between the two format of dta storage of corpora.</p>
<ul>
<li>The reader non familiar with quanteda should have a look at <em>Quick Start</em> available on the website of the project :</li>
</ul>
<p><a href="https://quanteda.io/articles/quickstart.html" class="uri">https://quanteda.io/articles/quickstart.html</a></p>
<ul>
<li>The reader non familiar with tidytext will find detailed explnation in the following book :</li>
</ul>
<p><a href="https://www.tidytextmining.com/" class="uri">https://www.tidytextmining.com/</a></p>
<p>We start by loading the corpus of news from <em>The Guardian (UK)</em> that has been transformed into quanteda corpus in the previous chapter (<strong>ref</strong>). we also transform the time variable in date and sort the news by historical order.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="data-check.html#cb2-1"></a>qd&lt;-<span class="kw">readRDS</span>(<span class="st">&quot;_data/qd/en_GBR_guardi.Rdata&quot;</span>)</span>
<span id="cb2-2"><a href="data-check.html#cb2-2"></a>qd<span class="op">$</span>date&lt;-<span class="kw">as.Date</span>(qd<span class="op">$</span>date)</span>
<span id="cb2-3"><a href="data-check.html#cb2-3"></a>qd&lt;-qd[<span class="kw">order</span>(qd<span class="op">$</span>date)]</span>
<span id="cb2-4"><a href="data-check.html#cb2-4"></a><span class="kw">str</span>(qd)</span></code></pre></div>
<pre><code>##  &#39;corpus&#39; Named chr [1:160855] &quot;20 great Ashes moments No1: Shane Warne&#39;s ball of the century, 1993 | Barney Ronay.\n.The Australian spinner’s &quot;| __truncated__ ...
##  - attr(*, &quot;names&quot;)= chr [1:160855] &quot;text117863&quot; &quot;text43964&quot; &quot;text149258&quot; &quot;text81406&quot; ...
##  - attr(*, &quot;docvars&quot;)=&#39;data.frame&#39;:	160855 obs. of  4 variables:
##   ..$ docname_: chr [1:160855] &quot;text117863&quot; &quot;text43964&quot; &quot;text149258&quot; &quot;text81406&quot; ...
##   ..$ docid_  : Factor w/ 160855 levels &quot;text117863&quot;,&quot;text43964&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##   ..$ segid_  : int [1:160855] 1 1 1 1 1 1 1 1 1 1 ...
##   ..$ date    : Date[1:160855], format: &quot;2013-04-29&quot; &quot;2013-05-02&quot; ...
##  - attr(*, &quot;meta&quot;)=List of 3
##   ..$ system:List of 5
##   .. ..$ package-version:Classes &#39;package_version&#39;, &#39;numeric_version&#39;  hidden list of 1
##   .. .. ..$ : int [1:3] 2 1 0
##   .. ..$ r-version      :Classes &#39;R_system_version&#39;, &#39;package_version&#39;, &#39;numeric_version&#39;  hidden list of 1
##   .. .. ..$ : int [1:3] 4 0 2
##   .. ..$ system         : Named chr [1:3] &quot;Windows&quot; &quot;x86-64&quot; &quot;CIST&quot;
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:3] &quot;sysname&quot; &quot;machine&quot; &quot;user&quot;
##   .. ..$ directory      : chr &quot;C:/claude/git/newsbook&quot;
##   .. ..$ created        : Date[1:1], format: &quot;2020-07-10&quot;
##   ..$ object:List of 2
##   .. ..$ unit   : chr &quot;documents&quot;
##   .. ..$ summary:List of 2
##   .. .. ..$ hash: chr(0) 
##   .. .. ..$ data: NULL
##   ..$ user  :List of 8
##   .. ..$ media_id     : num 300560
##   .. ..$ media_name   : chr &quot;The Guardian UK&quot;
##   .. ..$ media_url    : chr &quot;http://www.theguardian.com/uk&quot;
##   .. ..$ language     : chr &quot;en&quot;
##   .. ..$ media_country: chr &quot;FRA&quot;
##   .. ..$ data_source  : chr &quot;Media Cloud &quot;
##   .. ..$ data_time    : chr &quot;Special extraction&quot;
##   .. ..$ data_author  : chr &quot;Elaborated by Claude Grasland&quot;</code></pre>
<p>This structure of data appears a bit tricky at first glance (especially for old user of quanteda that has experimented modification between version 1 and 2 …) but it offers very good guaranties of quality and efficiency. As explained by the author of the quanteda package :</p>
<blockquote>
<p>A corpus is designed to be a “library” of original documents that have been converted to plain, UTF-8 encoded text, and stored along with meta-data at the corpus level and at the document-level. We have a special name for document-level meta-data: <em>docvars</em>. These are variables or features that describe attributes of each document.A corpus is designed to be a more or less static container of texts with respect to processing and analysis. This means that the texts in corpus are not designed to be changed internally through (for example) cleaning or pre-processing steps, such as stemming or removing punctuation. Rather, texts can be extracted from the corpus as part of processing, and assigned to new objects, but the idea is that the corpus will remain as an original reference copy so that other analyses – for instance those in which stems and punctuation were required, such as analyzing a reading ease index – can be performed on the same corpus.</p>
</blockquote>
<p>With the new data structure it is for example easy to extract a specific text from the corpus with an extractor, called <code>texts()</code>. We can also have an easy access to information associated to each document like the date in our example. For example the news 666 is defined by :</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="data-check.html#cb4-1"></a><span class="kw">texts</span>(qd)[<span class="dv">666</span>]</span></code></pre></div>
<pre><code>##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    text156682 
## &quot;The state pension top-up that no one seems to want.\n.More than a quarter of a million people were expected to boost their pension; fewer than 4,000 have signed up so farIt’s the great deal no one seems to know about. The government is running a scheme whereby older people can buy extra state pension on what experts say are “very favourable” terms – but the take-up so far has been shockingly low.The official prediction was that 265,000 people would take advantage of the chance to boost their retirement income by making an upfront payment. But figures published this week show that fewer than 4,000 signed up in the first six months. Here we explain how the scheme works, why you should do it, and things to watch out for. Continue reading...&quot;</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="data-check.html#cb6-1"></a>qd<span class="op">$</span>date[<span class="dv">666</span>]</span></code></pre></div>
<pre><code>## [1] &quot;2016-08-20&quot;</code></pre>
<p>For those who really don’t want to use quanteda, it is also simple to convert it to other format and in particular a simple data.frame where we can find only the id of document, the text and the document level information. But we have lost all the other information like the document metadata.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="data-check.html#cb8-1"></a>df&lt;-<span class="kw">convert</span>(qd, <span class="dt">to=</span><span class="st">&quot;data.frame&quot;</span>)</span>
<span id="cb8-2"><a href="data-check.html#cb8-2"></a><span class="kw">head</span>(df)</span></code></pre></div>
<pre><code>##       doc_id
## 1 text117863
## 2  text43964
## 3 text149258
## 4  text81406
## 5 text104515
## 6   text9780
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              text
## 1 20 great Ashes moments No1: Shane Warne&#39;s ball of the century, 1993 | Barney Ronay.\n.The Australian spinner’s drifting, leaping leg-break to bowl Mike Gatting at Old Trafford introduced the cricket world to a new heroThere shouldn’t really be anything left to say about Warne’s Ball, otherwise known as Shane Warne’s opening delivery in Ashes cricket; or more commonly as The Ball of the Century, Birth of A Superstar, Awakening of the Kraken, the Jailhouse Rock of Australia’s custard-blond leg-break Elvis, and so on ad infinitum.In part this is simply because so much has already been said and written, an entire vast, groaning medieval library of ball talk, from the historian’s cold-eyed anatomy to the biographer’s partisan gurgles. And partly because the ball itself has become so enmeshed in its own mille-feuille of well-worn superlatives that there is a fear the moment itself has also become a cliche, a mini-industry of middle-aged hyperbole, asserting its own wonderfulness more insistently with each receding year. Perhaps Warne’s Ball might even have begun to look a bit like Warne himself these days: waxworked and framed, glistening with the acquired privilege of athletic celebrity and generally hanging around the place being oppressively eminent long after its own meaningful cricketing life has ended. Continue reading...
## 2                                                                                                                                                                                    20 great Ashes moments No2: the miracle of Cardiff, 2009 | Rob Bagchi.\n.Spectators who dared to look did so through their fingers as Monty Panesar and Jimmy Anderson held on for a drawIt is to Britain’s martial and imperial past that the metaphors for a home team’s defiance of overwhelming odds still habitually turn when honour, even in retreat, is salvaged from a seemingly inevitable ignominious fate. Dunkirk and its fabled spirit, a cornered belligerence and breezy fortitude in the face of imminent catastrophe, is the most common analogy but for England’s draw with Australia in the opening match of the 2009 Ashes series, something more symbolically Welsh was required to commemorate Cardiff and the country’s first ever Test.For the generations brought up on the annual televised screening of the 1964 film Zulu, the Battle of Rorke’s Drift and specifically the poignant if apocryphal singing of Men of Harlech by a hopelessly outnumbered company of the 24th Regiment of Foot valiantly defending their position and lives against 4,000 warriors, suggested the obvious soundtrack to the highlight reels of Sunday at the Swalec Stadium. Continue reading...
## 3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     The Joy of Six: red mist in football | Scott Murray and Rob Smyth.\n.Frank Rijkaard and Rudi Völler bond during West Germany&#39;s match against Holland at Italia 90. Photograph: Getty Images
## 4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Official World Cup balls: a potted history – in pictures.\n.Since 1970, Adidas have had the honour of producing the official match balls for the World Cup finals. With the announcement for the Telstar 18 for 2018 Russia, we take a look back at the balls that have graced the finals over the past 43 years Continue reading...
## 5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     Weather view: photos of this week&#39;s weather – by readers around the world.\n.We’re looking for your best beautiful and striking weather-related photos. From cloudy skies to glorious sunshine, share your pictures of this week’s weather and we’ll choose a selection to be printed in the paperFrom heatwaves in Australia, to snow in the US and Middle East, to storms and flooding in the UK, you’ve shared some dramatic images with the Guardian. But the weather doesn’t have to be extreme to make a great picture. Wherever you are in the world, we’d love to see your most striking photos of this week’s weather.In your description, please tell us where you took the photo (it can be anywhere in the world) and the date you took it (it should be in the last week). Continue reading...
## 6                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                The Joy of Six: football pantomime villains | Paul Doyle.\n.From the loathing for Pepe’s playacting to the puzzling rancour Michael Owen inspires, football fans love to hate a bad guyA distinction must be drawn between “football pantomime villains” and real-life villains associated with football, such as Uday Hussein, Robert Maxwell or Lee Hughes, men who have committed misdeeds too grave for any enjoyment to be had from contemplating them. Continue reading...
##         date
## 1 2013-04-29
## 2 2013-05-02
## 3 2013-11-29
## 4 2013-12-03
## 5 2014-01-13
## 6 2014-04-18</code></pre>
</div>
<div id="check-1-length-of-texts" class="section level2">
<h2><span class="header-section-number">3.2</span> CHECK 1 : length of texts</h2>
<p>We can use the summary command applied to the whole corpus in order to obtain for each text the number of sentences and words. This operation can take some time because quanteda will proceed to a tokenization of the corpus. We suggest to store this information in the quanteda object.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="data-check.html#cb10-1"></a><span class="co"># Compute number of sentences and tokens</span></span>
<span id="cb10-2"><a href="data-check.html#cb10-2"></a>tokeninfo &lt;-<span class="st"> </span><span class="kw">summary</span>(qd,<span class="kw">length</span>(qd))</span>
<span id="cb10-3"><a href="data-check.html#cb10-3"></a></span>
<span id="cb10-4"><a href="data-check.html#cb10-4"></a><span class="co">#store in quanteda object</span></span>
<span id="cb10-5"><a href="data-check.html#cb10-5"></a><span class="kw">docvars</span>(qd, <span class="dt">field=</span><span class="st">&quot;Tokens&quot;</span>)&lt;-tokeninfo<span class="op">$</span>Tokens</span>
<span id="cb10-6"><a href="data-check.html#cb10-6"></a><span class="kw">docvars</span>(qd, <span class="dt">field=</span><span class="st">&quot;Sentences&quot;</span>)&lt;-tokeninfo<span class="op">$</span>Sentences</span>
<span id="cb10-7"><a href="data-check.html#cb10-7"></a></span>
<span id="cb10-8"><a href="data-check.html#cb10-8"></a><span class="co"># Visualize</span></span>
<span id="cb10-9"><a href="data-check.html#cb10-9"></a><span class="kw">head</span>(<span class="kw">docvars</span>(qd))</span></code></pre></div>
<pre><code>##         date Tokens Sentences
## 1 2013-04-29    234         5
## 2 2013-05-02    202         4
## 3 2013-11-29     37         3
## 4 2013-12-03     67         3
## 5 2014-01-13    156         6
## 6 2014-04-18     85         3</code></pre>
<div id="number-of-sentences" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Number of sentences</h3>
<p>We examine the number of sentences of texts</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="data-check.html#cb12-1"></a>nsent&lt;-qd<span class="op">$</span>Sentences</span>
<span id="cb12-2"><a href="data-check.html#cb12-2"></a><span class="kw">summary</span>(nsent)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   1.000   3.000   4.000   5.694   7.000 204.000</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="data-check.html#cb14-1"></a>p&lt;-<span class="kw">ggplot</span>(<span class="kw">docvars</span>(qd),<span class="kw">aes</span>(<span class="dt">x=</span>Sentences))<span class="op">+</span><span class="kw">geom_histogram</span>()</span>
<span id="cb14-2"><a href="data-check.html#cb14-2"></a>p</span></code></pre></div>
<p><img src="newsbook_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>The distribution appears strongly asymmetric with a majority of news with 3 to 7 sentences but a minoity with much longer size. We can zoom on the news with less than 20 sentences for a better view of the distribution :</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="data-check.html#cb15-1"></a>qd2&lt;-qd[qd<span class="op">$</span>Sentences<span class="op">&lt;</span><span class="dv">20</span>]</span>
<span id="cb15-2"><a href="data-check.html#cb15-2"></a>p&lt;-<span class="kw">ggplot</span>(<span class="kw">docvars</span>(qd2),<span class="kw">aes</span>(<span class="dt">x=</span>Sentences))<span class="op">+</span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>,)</span>
<span id="cb15-3"><a href="data-check.html#cb15-3"></a>p</span></code></pre></div>
<p><img src="newsbook_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>At this point, it could be useful to proceed to an harmonisation of the length of texts with two possibles options :</p>
<ul>
<li>delete the news with too much sentences</li>
<li>keep only the k first sentences of each text with the <em>corpus_reshape</em> function.</li>
</ul>
<p>But we do not want here to anaticipate on what will decide the user so we let the issue open.</p>
</div>
<div id="number-of-tokens" class="section level3">
<h3><span class="header-section-number">3.2.2</span> Number of tokens</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="data-check.html#cb16-1"></a>nbtoks&lt;-qd<span class="op">$</span>Tokens</span>
<span id="cb16-2"><a href="data-check.html#cb16-2"></a><span class="kw">summary</span>(nbtoks)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    12.0   101.0   127.0   146.5   179.0  3362.0</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="data-check.html#cb18-1"></a>p&lt;-<span class="kw">ggplot</span>(<span class="kw">docvars</span>(qd),<span class="kw">aes</span>(<span class="dt">x=</span>Tokens))<span class="op">+</span><span class="kw">geom_histogram</span>()</span>
<span id="cb18-2"><a href="data-check.html#cb18-2"></a>p</span></code></pre></div>
<p><img src="newsbook_files/figure-html/unnamed-chunk-9-1.png" width="672" />
We observe the same asymmetry for the number of tokens. In the ajority of case, the number of tokens is comprise between 100 and 180 Tokens but the minimum is 12 and the maximum 3362.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="data-check.html#cb19-1"></a>p&lt;-<span class="kw">ggplot</span>(<span class="kw">docvars</span>(qd2),<span class="kw">aes</span>(<span class="dt">x=</span>Tokens))<span class="op">+</span><span class="kw">geom_histogram</span>(<span class="dt">stat_bin=</span><span class="dv">25</span>)<span class="op">+</span><span class="kw">scale_x_continuous</span>(<span class="dt">lim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">300</span>))</span>
<span id="cb19-2"><a href="data-check.html#cb19-2"></a>p</span></code></pre></div>
<p><img src="newsbook_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
</div>
<div id="check-2-time-distribution" class="section level2">
<h2><span class="header-section-number">3.3</span> CHECK 2 : Time distribution</h2>
<p>The second step is to verify the stability of the news through times, in terms of frequencies. The main danger here is the risk to observe discontinuities in the distribution which could induce biases in the comparison of evolution through time.</p>
<div id="news-without-date" class="section level3">
<h3><span class="header-section-number">3.3.1</span> News without date</h3>
<p>After a check of the time distribution of news, we eliminate 22 news without date</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="data-check.html#cb20-1"></a><span class="kw">summary</span>(<span class="kw">docvars</span>(qd,<span class="st">&quot;date&quot;</span>))</span></code></pre></div>
<pre><code>##         Min.      1st Qu.       Median         Mean      3rd Qu.         Max. 
## &quot;2013-04-29&quot; &quot;2017-07-22&quot; &quot;2018-07-04&quot; &quot;2018-07-19&quot; &quot;2019-07-25&quot; &quot;2020-06-30&quot; 
##         NA&#39;s 
##         &quot;22&quot;</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="data-check.html#cb22-1"></a>qd&lt;-qd[<span class="kw">is.na</span>(qd<span class="op">$</span>date)<span class="op">==</span>F]</span></code></pre></div>
</div>
<div id="distribution-of-news-through-time" class="section level3">
<h3><span class="header-section-number">3.3.2</span> Distribution of news through time</h3>
<p>We introduce a function when_count for an easier extraction of time series with different levels of time span. The interest of this function is to add zero value for time period where no news has been observed, which would not be the case with a simple table function.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="data-check.html#cb23-1"></a><span class="co">#### ---------------- when_count -----------------</span></span>
<span id="cb23-2"><a href="data-check.html#cb23-2"></a><span class="co">#&#39; @title identify number of news per time period</span></span>
<span id="cb23-3"><a href="data-check.html#cb23-3"></a><span class="co">#&#39; @name when_count</span></span>
<span id="cb23-4"><a href="data-check.html#cb23-4"></a><span class="co">#&#39; @description count the numbers of news per time period and add zero for missing period</span></span>
<span id="cb23-5"><a href="data-check.html#cb23-5"></a><span class="co">#&#39; @param corpus a corpus of news (in qd format) with a column &quot;time&quot;</span></span>
<span id="cb23-6"><a href="data-check.html#cb23-6"></a><span class="co">#&#39; @param span a time period of aggregation (days, weeks, months, year)</span></span>
<span id="cb23-7"><a href="data-check.html#cb23-7"></a></span>
<span id="cb23-8"><a href="data-check.html#cb23-8"></a></span>
<span id="cb23-9"><a href="data-check.html#cb23-9"></a></span>
<span id="cb23-10"><a href="data-check.html#cb23-10"></a>when_count&lt;-<span class="cf">function</span>(<span class="dt">corpus =</span> qd, <span class="dt">span =</span> <span class="st">&#39;weeks&#39;</span> )</span>
<span id="cb23-11"><a href="data-check.html#cb23-11"></a>{</span>
<span id="cb23-12"><a href="data-check.html#cb23-12"></a> <span class="co"># corpus&lt;-qd</span></span>
<span id="cb23-13"><a href="data-check.html#cb23-13"></a><span class="co">#  span&lt;-&quot;weeks&quot;</span></span>
<span id="cb23-14"><a href="data-check.html#cb23-14"></a></span>
<span id="cb23-15"><a href="data-check.html#cb23-15"></a>  </span>
<span id="cb23-16"><a href="data-check.html#cb23-16"></a>  time&lt;-<span class="kw">docvars</span>(corpus,<span class="st">&quot;date&quot;</span>)</span>
<span id="cb23-17"><a href="data-check.html#cb23-17"></a>  tab&lt;-tibble<span class="op">::</span><span class="kw">tibble</span>(<span class="dt">date=</span><span class="kw">as.Date</span>(time))</span>
<span id="cb23-18"><a href="data-check.html#cb23-18"></a>  item_date &lt;-<span class="st"> </span>tab <span class="op">%&gt;%</span></span>
<span id="cb23-19"><a href="data-check.html#cb23-19"></a><span class="st">    </span><span class="kw">group_by</span>(<span class="dt">date =</span> <span class="kw">cut</span>(date, span, <span class="dt">start.on.monday =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></span>
<span id="cb23-20"><a href="data-check.html#cb23-20"></a><span class="st">    </span><span class="kw">summarise</span>(<span class="dt">nb =</span> <span class="kw">n</span>())</span>
<span id="cb23-21"><a href="data-check.html#cb23-21"></a>  item_date<span class="op">$</span>date &lt;-<span class="st"> </span><span class="kw">as.Date</span>(item_date<span class="op">$</span>date)</span>
<span id="cb23-22"><a href="data-check.html#cb23-22"></a>  all_date&lt;-<span class="kw">data_frame</span>(<span class="dt">date=</span><span class="kw">seq</span>(<span class="kw">min</span>(<span class="kw">as.Date</span>(item_date<span class="op">$</span>date)),<span class="kw">max</span>(<span class="kw">as.Date</span>(item_date<span class="op">$</span>date)),span))</span>
<span id="cb23-23"><a href="data-check.html#cb23-23"></a>  tem_date&lt;-<span class="kw">left_join</span>(all_date,item_date)</span>
<span id="cb23-24"><a href="data-check.html#cb23-24"></a>  item_date<span class="op">$</span>nb[<span class="kw">is.na</span>(item_date<span class="op">$</span>nb)]&lt;-<span class="dv">0</span></span>
<span id="cb23-25"><a href="data-check.html#cb23-25"></a>  </span>
<span id="cb23-26"><a href="data-check.html#cb23-26"></a>  <span class="kw">return</span>(item_date)</span>
<span id="cb23-27"><a href="data-check.html#cb23-27"></a>}</span></code></pre></div>
<div id="daily-distribtion" class="section level4">
<h4><span class="header-section-number">3.3.2.1</span> daily distribtion</h4>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="data-check.html#cb24-1"></a>news_by_day&lt;-<span class="kw">when_count</span>(qd,<span class="dt">span=</span><span class="st">&quot;days&quot;</span>)</span>
<span id="cb24-2"><a href="data-check.html#cb24-2"></a>p&lt;-<span class="kw">ggplot</span>(news_by_day, <span class="kw">aes</span>(<span class="dt">x=</span>date, <span class="dt">y=</span>nb)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>()<span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="kw">max</span>(news_by_day<span class="op">$</span>nb)))</span>
<span id="cb24-3"><a href="data-check.html#cb24-3"></a>p</span></code></pre></div>
<p><img src="newsbook_files/figure-html/news_by_day-1.png" width="672" />
We discover here that, despite the fact that the first news is observed the 29 April 2013, it is only after the 15th August 2016 that the flow of news become regular with an average level of 100 news per day. Therefore we reduce the sample to this period :</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="data-check.html#cb25-1"></a>qd&lt;-<span class="kw">corpus_subset</span>(qd,qd<span class="op">$</span>date<span class="op">&gt;</span><span class="kw">as.Date</span>(<span class="st">&quot;2016-08-14&quot;</span>))</span>
<span id="cb25-2"><a href="data-check.html#cb25-2"></a>news_by_day&lt;-<span class="kw">when_count</span>(qd,<span class="dt">span=</span><span class="st">&quot;days&quot;</span>)</span>
<span id="cb25-3"><a href="data-check.html#cb25-3"></a>p&lt;-<span class="kw">ggplot</span>(news_by_day, <span class="kw">aes</span>(<span class="dt">x=</span>date, <span class="dt">y=</span>nb)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>()<span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="kw">max</span>(news_by_day<span class="op">$</span>nb)))</span>
<span id="cb25-4"><a href="data-check.html#cb25-4"></a>p</span></code></pre></div>
<p><img src="newsbook_files/figure-html/news_by_day_2-1.png" width="672" />
For the new period, we can say that the flow is relatively regular, with very few discontinuities corresponding to zero news during one or several days.</p>
</div>
<div id="weekly-distribtion" class="section level4">
<h4><span class="header-section-number">3.3.2.2</span> weekly distribtion</h4>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="data-check.html#cb26-1"></a>news_by_week&lt;-<span class="kw">when_count</span>(qd,<span class="dt">span=</span><span class="st">&quot;weeks&quot;</span>)</span>
<span id="cb26-2"><a href="data-check.html#cb26-2"></a>p&lt;-<span class="kw">ggplot</span>(news_by_week, <span class="kw">aes</span>(<span class="dt">x=</span>date, <span class="dt">y=</span>nb)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="kw">max</span>(news_by_week<span class="op">$</span>nb)))</span>
<span id="cb26-3"><a href="data-check.html#cb26-3"></a>p</span></code></pre></div>
<p><img src="newsbook_files/figure-html/news_by_week-1.png" width="672" />
The analysis by week reveals a clear perturabation during the weeks of 23 March 2019 and 3 February 2020. The other decline observed at the end of the years 2016, 2018, 2019 and 2020 are not related to problems of data collection but rather to a reduction of the activity of journalist between X’mas and New Year.Surprisingly, this decline is not observed at the end of the year 2017. The final decline is related to the fact that the final week starting the 29 June 2020 is not complete because colection stopped the 30 june 2020.</p>
</div>
</div>
</div>
<div id="check-3-suspect-words" class="section level2">
<h2><span class="header-section-number">3.4</span> CHECK 3 : Suspect words</h2>
<p>A classical problem with the news collected from RSS is the existence of sequence of words that are not related to news itself but to newspaper structure. For example, the systematic addition of a copyright (<em>(c) the Journal</em>) or the introduction of references (<em>See also</em>) and many other things that can be considered as external to the message provided by the news itself. Here they are no miracle solution that can produce an automatic correction. But some technics can help the analyst to simplify the task of correction.</p>
<div id="tips-1-simple-word-fequencies" class="section level3">
<h3><span class="header-section-number">3.4.1</span> Tips 1 : simple word fequencies</h3>
<p>A simple analysis of most frequent tokens can help to discover suspect words.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="data-check.html#cb27-1"></a>toks&lt;-<span class="kw">tokens</span>(qd, <span class="dt">remove_numbers =</span> <span class="ot">TRUE</span>, <span class="dt">remove_punct =</span> <span class="ot">TRUE</span>, <span class="dt">remove_separators =</span><span class="ot">TRUE</span>)</span>
<span id="cb27-2"><a href="data-check.html#cb27-2"></a>dfm &lt;-<span class="st"> </span><span class="kw">dfm</span>(toks, <span class="dt">remove =</span> <span class="kw">stopwords</span>(<span class="st">&quot;english&quot;</span>))</span>
<span id="cb27-3"><a href="data-check.html#cb27-3"></a>top10&lt;-<span class="kw">textstat_frequency</span>(dfm,<span class="dt">n=</span><span class="dv">10</span>)</span>
<span id="cb27-4"><a href="data-check.html#cb27-4"></a><span class="kw">kable</span>(top10)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">feature</th>
<th align="right">frequency</th>
<th align="right">rank</th>
<th align="right">docfreq</th>
<th align="left">group</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">continue</td>
<td align="right">163448</td>
<td align="right">1</td>
<td align="right">160774</td>
<td align="left">all</td>
</tr>
<tr class="even">
<td align="left">reading</td>
<td align="right">163079</td>
<td align="right">2</td>
<td align="right">160774</td>
<td align="left">all</td>
</tr>
<tr class="odd">
<td align="left">new</td>
<td align="right">48053</td>
<td align="right">3</td>
<td align="right">33788</td>
<td align="left">all</td>
</tr>
<tr class="even">
<td align="left">one</td>
<td align="right">46204</td>
<td align="right">4</td>
<td align="right">35371</td>
<td align="left">all</td>
</tr>
<tr class="odd">
<td align="left">first</td>
<td align="right">36064</td>
<td align="right">5</td>
<td align="right">27215</td>
<td align="left">all</td>
</tr>
<tr class="even">
<td align="left">people</td>
<td align="right">34901</td>
<td align="right">6</td>
<td align="right">24858</td>
<td align="left">all</td>
</tr>
<tr class="odd">
<td align="left">us</td>
<td align="right">34458</td>
<td align="right">7</td>
<td align="right">23278</td>
<td align="left">all</td>
</tr>
<tr class="even">
<td align="left">said</td>
<td align="right">31615</td>
<td align="right">8</td>
<td align="right">26348</td>
<td align="left">all</td>
</tr>
<tr class="odd">
<td align="left">years</td>
<td align="right">29787</td>
<td align="right">9</td>
<td align="right">23763</td>
<td align="left">all</td>
</tr>
<tr class="even">
<td align="left">world</td>
<td align="right">28968</td>
<td align="right">10</td>
<td align="right">20442</td>
<td align="left">all</td>
</tr>
</tbody>
</table>
<p>The simple examination of the top 10 reveals the existence of two suspect words <em>continue</em> and <em>reading</em>. They can be explained by the existence of the string <em>Continue Reading</em> at the end of the majority of news. For example :</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="data-check.html#cb28-1"></a><span class="kw">texts</span>(qd)[<span class="dv">24</span>]</span></code></pre></div>
<pre><code>##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        text91459 
## &quot;Liverpool have been rebuilding … so why is Alberto Moreno still at left-back?.\n.The Spanish defender was exposed on numerous occasions against Arsenal and looks a clear weak link in a squad that Jürgen Klopp has otherwise strengthenedLiverpool started their season in triumphant fashion on Sunday with a 4-3 win at the Emirates that included two amazing goals from Philippe Coutinho (if we think he meant to score the second off his shin), a stunning strike from Sadio Mané and some, shall we say, inconsistent defending by the left-back Alberto Moreno. Related: Liverpool and Coutinho stun stuttering Arsenal in seven-goal thriller  Continue reading...&quot;</code></pre>
</div>
<div id="tips-2-most-frequent-n-grams" class="section level3">
<h3><span class="header-section-number">3.4.2</span> Tips 2 : most frequent n-grams</h3>
<p>Another approach consist in the extraction of most frequent n-grams i.e. couples of words frequently associated. This can be done with various value of n. But it is generally sufficient to check for n= 2, 3 or 4.*</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="data-check.html#cb30-1"></a>bigram&lt;-<span class="kw">tokens_ngrams</span>(toks,<span class="dt">n=</span><span class="kw">c</span>(<span class="dv">2</span>))</span>
<span id="cb30-2"><a href="data-check.html#cb30-2"></a>dfm2&lt;-<span class="kw">dfm</span>(bigram)</span>
<span id="cb30-3"><a href="data-check.html#cb30-3"></a>top10&lt;-<span class="kw">textstat_frequency</span>(dfm2,<span class="dt">n=</span><span class="dv">10</span>)</span>
<span id="cb30-4"><a href="data-check.html#cb30-4"></a><span class="kw">kable</span>(top10)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">feature</th>
<th align="right">frequency</th>
<th align="right">rank</th>
<th align="right">docfreq</th>
<th align="left">group</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">continue_reading</td>
<td align="right">160775</td>
<td align="right">1</td>
<td align="right">160774</td>
<td align="left">all</td>
</tr>
<tr class="even">
<td align="left">of_the</td>
<td align="right">114191</td>
<td align="right">2</td>
<td align="right">72929</td>
<td align="left">all</td>
</tr>
<tr class="odd">
<td align="left">in_the</td>
<td align="right">99843</td>
<td align="right">3</td>
<td align="right">67796</td>
<td align="left">all</td>
</tr>
<tr class="even">
<td align="left">to_the</td>
<td align="right">46934</td>
<td align="right">4</td>
<td align="right">38313</td>
<td align="left">all</td>
</tr>
<tr class="odd">
<td align="left">on_the</td>
<td align="right">40855</td>
<td align="right">5</td>
<td align="right">33645</td>
<td align="left">all</td>
</tr>
<tr class="even">
<td align="left">for_the</td>
<td align="right">33354</td>
<td align="right">6</td>
<td align="right">28210</td>
<td align="left">all</td>
</tr>
<tr class="odd">
<td align="left">at_the</td>
<td align="right">32413</td>
<td align="right">7</td>
<td align="right">27309</td>
<td align="left">all</td>
</tr>
<tr class="even">
<td align="left">in_a</td>
<td align="right">32264</td>
<td align="right">8</td>
<td align="right">27635</td>
<td align="left">all</td>
</tr>
<tr class="odd">
<td align="left">to_be</td>
<td align="right">30879</td>
<td align="right">9</td>
<td align="right">25535</td>
<td align="left">all</td>
</tr>
<tr class="even">
<td align="left">of_a</td>
<td align="right">29399</td>
<td align="right">10</td>
<td align="right">25276</td>
<td align="left">all</td>
</tr>
</tbody>
</table>
<p>Here, the conclusion is clear concerning our usual suspect. We can therefore proceed to the elimination of the problem with a regular expression</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="data-check.html#cb31-1"></a><span class="kw">texts</span>(qd)&lt;-<span class="kw">gsub</span>(<span class="st">&quot;continue reading...&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="kw">texts</span>(qd))</span>
<span id="cb31-2"><a href="data-check.html#cb31-2"></a><span class="kw">texts</span>(qd)&lt;-<span class="kw">gsub</span>(<span class="st">&quot;continue reading&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="kw">texts</span>(qd))</span></code></pre></div>
</div>
</div>
<div id="check-4-human-expertise" class="section level2">
<h2><span class="header-section-number">3.5</span> CHECK 4 : Human expertise</h2>
<p>All the previous check can not replace human expert. Therefore, we strongly suggest to examine a random sample of texts extract from the news in order to have an empirical view on the texts that will be further subject to time consuming analysis. It is certainly not a vaste of time to discover issues early and avoid to replicate the whole work (pity for the climate !).</p>
<p>A random sample of news can be easily extracted with corpus_sample function. Let’s take a sample of 10 here (but 100 would be certainly better)</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="data-check.html#cb32-1"></a>samp&lt;-<span class="kw">corpus_sample</span>(qd,<span class="dt">size=</span><span class="dv">10</span>)</span>
<span id="cb32-2"><a href="data-check.html#cb32-2"></a><span class="kw">texts</span>(samp)</span></code></pre></div>
<pre><code>##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     text119206 
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               &quot;Britain&#39;s contaminated blood scandal: ‘I need them to admit they killed our son’.\n.In the 1970s and 80s, 4,689 British haemophiliacs were treated with contaminated blood products. So far, more than half of them have died. The government knew there were risks involved. The patients didn’t. Will they ever get justice?It has been called the biggest treatment disaster in the history of the NHS, and a “horrific human tragedy”. But Su Gorman, whose husband has endured years of ill health as a result of haemophilia treatment, does not believe this adequately describes Britain’s contaminated blood scandal. As far as she is concerned, it is simply a crime.In the 1970s and 80s, 4,689 haemophiliacs became infected with hepatitis C and HIV after they were treated with contaminated blood products supplied by the NHS. Of those infected, 2,883 have since died. Continue reading...&quot; 
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     text138656 
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 &quot;London cycle courier &#39;was punished for refusing work after eight hours in cold&#39;.\n.Andrew Boxer is latest worker to launch tribunal case after he was not entitled to holiday pay, sickness benefit or pensionA cycle courier delivering parcels in central London has described being punished for refusing work after eight hours of cycling in snowy weather, saying he received no paid breaks or holiday pay.Andrew Boxer is the latest to take on the battle to be classified as a “worker” rather than an independent contractor. Continue reading...&quot; 
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      text34686 
## &quot;Experimental music&#39;s reliance on Facebook is counterintuitive – but there are alternatives.\n.While Facebook has fostered open communities in alternative music, they can disappear with a tweak of an algorithm. Fortunately, non-corporate marketing tools are emergingIn the mid-90s when I first put on club nights in Leeds, I’d wake up far earlier than my student routines demanded and spend hours stapling rudimentary photocopied posters to the trees that lined the main route to campus. I knew they’d be removed by the end of each day, but if I could just get the message out to a university’s worth of bleary-eyed students each morning we might just manage to assemble an audience at the other end of the night.It was the closest we ever got to a targeted advertising campaign, the likes of which Trump, leave.eu, and seemingly every political party uses Facebook for these days. The good thing was we didn’t have to steal any data to do so; the downside was we had no idea who was coming until the night. Our posters were a one–way broadcast with no satisfying feedback loop reassuring us of success. So it’s no wonder that now I’ve graduated to running Borealis, a multi-venue Norwegian experimental music festival, the Facebook event page and all the advertising potential that comes with it has become one of the mainstays of our event marketing, and a more convenient, and arguably more effective, platform for building audiences than those early morning staple gun sorties. Continue reading...&quot; 
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      text73929 
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  &quot;Coventry drivers could get £3,000 transport vouchers for ditching cars.\n.Pilot project will offer people vouchers for public transport, taxis or car clubsDrivers in Coventry could be paid up to £3,000 a year in transport vouchers to ditch their cars under a UK-first scheme.The Transport for the West Midlands (TfWM) pilot project is designed to ease traffic congestion and improve air quality in the city. Continue reading...&quot; 
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      text46257 
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          &quot;Why speaking Spanish is becoming dangerous in America.\n.Reports of people being berated or attacked while communicating in the world’s second most spoken language are on the riseSandy was trying to communicate with a colleague. Although her presence was unusual as a Latinx lawyer at a top southern California non-profit, she was used to talking to people in any language she wanted to. After all, she’d graduated from a top law school and worked near her Los Angeles-area, Latin-centric hometown.But this time was different. She was speaking to a member of the custodian staff in Spanish about a trivial matter when an older white female executive forcefully told her to stop. That she should not socialize in another language because “other people” might think they were talking trash about them. Continue reading...&quot; 
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      text61329 
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               &quot;Uber aims for stock market debut value of up to $90bn.\n.It would be highest valuation for US tech company since Facebook floated in 2012Uber is set to unveil the terms of its hotly anticipated stock market flotation, with the ride-hailing service targeting a valuation of $80bn to $90bn – substantially less than bankers had suggested the business could be worth but still the highest valuation for a US tech company since Facebook floated in 2012.The 10-year old company, which recently warned it may never “achieve profitability”, is expected to release documents on Friday outlining details of its initial public offering, including the number of shares to be sold and the proposed price range. Continue reading...&quot; 
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      text10875 
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            &quot;Everyone in Welsh care homes to be offered coronavirus tests.\n.Move follows scientific advice and brings country in line with England, says health ministerCoronavirus – latest updatesSee all our coronavirus coverageEveryone in care homes in Wales will be able to get a coronavirus test, the Welsh government has said.The health minister, Vaughan Gething, said the change follows the latest scientific advice and brings Wales in line with England. The move means every care home in Wales will have access to testing and be able to order online kits for residents and staff. Continue reading...&quot; 
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      text61704 
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   &quot;Could the coronavirus mutate if a vaccine can&#39;t be found in time?.\n.As scientists race to trace out paths the virus might take we ask the crucial questionsIn just a month, the coronavirus outbreak has snowballed from a handful of cases to more than 40,000, reaching four continents and prompting an all-out battle to stop the spread across China and beyond. As those in Wuhan face shortages of hospital beds and supplies that have been likened to “wartime conditions”, experts and scientists are attempting to trace out the possible paths that the virus might take. Continue reading...&quot; 
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        text978 
##                                                                                                                                                                                                                                                                                                                                                         &quot;‘You want to shout: Stop saying that! Look at your own school funding figures!’.\n.What makes a quiet and successful headteacher challenge the government and write to 2.5m families about the unfairness of school funding?It’s Saturday morning and Jules White is up early, running the family dogs along the beach before accompanying one of his two teenage daughters to a race walking session. He does the wiggly-hips sport to keep his daughter company, he says, but it’s also a good distraction because the concentration needed to keep one foot on the ground at all times keeps his mind off a more pressing problem – school funding.White is the secondary headteacher who stuck his head above the parapet and started what could prove to be the most effective grassroots campaign in the history of British education. For the last two years he has led the Worth Less? campaign, joined by 4,000 other heads all speaking out about the funding system that leaves their schools millions of pounds out of pocket compared with others in different parts of the country. They recently wrote to 2.5m homes to tell parents about school cash shortages. Continue reading...&quot; 
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      text23000 
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               &quot;Where to get a drink for under $20 in Las Vegas.\n.In the deserts of Nevada, there are plenty of watering holes to quench your thirst that won’t leave you out of pocketAlthough it may seem as if Las Vegas is all about extravagance – you can pick up a cocktail here for $10,000 should you so wish – there are a vast array of drinking options on offer throughout the city, from dive bars to affordable cocktail establishments to glittering hotels. On or off the Strip, there’s a beverage with your name on it.CommonwealthA 558 sq metre (6,000 sq ft) cocktail bar full of prohibition-era personality. It attracts a youngish crowd that come for the reasonably priced drinks (cocktails from $9) and regular dance parties. There’s a rooftop bar with a DJ and views of Fremont Street, and the basement houses a “secret” speakeasy, the Laundry Room, an intimate space that requires booking (by text message only).525 E. Fremont St Continue reading...&quot;</code></pre>
<p>The sample appears correct but some corrections could be added. We could for example eliminate the double quotes that will complicate the analysis of text. We could also decide to eliminate the final sentences that are not completed, etc. But it can also be important to keep the text as similar as possible to the initial one and to delay these final check to the next chapter where the data will be focused on a specific question.</p>
<p>The last step here is to store the clean file for further use. Here we use the initial name but with adding information on the period of coverage.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="data-check.html#cb34-1"></a><span class="kw">saveRDS</span>(qd, <span class="st">&quot;_data/qd/en_GBR_guardi_20160815_20200630.Rdata&quot;</span>)</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-collect.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ClaudeGrasland/newsbook/edit/master/13-data_check.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["newsbook.pdf", "newsbook.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
